=== GPT-2 Training Script (C++ Implementation) ===





 rank = 1





=== GPT-2 Training Script (C++ Implementation) ===
Configuration:
  V: 50304
  T: 1024
  C: 768
  n_layers: 6
  B =8, T =1024
  global_batch: 65536
  grad_accum_steps: 4





 rank = 0






Initializing model on CUDA device 0...


 shape = [ 25152 , 768 ] 


 size = 19316736 rank =  0 name = DEmbeddingVParallel_weight


 shape = [ 25152 , 768 ] 


 size = 19316736 rank =  1 name = DEmbeddingVParallel_weight


 shape = [ 1024 , 768 ] 


 size = 786432 rank =  0 name = DEmbedding_weight
default DTensor contructor :  size = 0 rank =  0
default DTensor contructor :  size = 0 rank =  0
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = DColumnLinear_weight


 shape = [ 1024 , 768 ] 


 size = 786432 rank =  1 name = DEmbedding_weight
default DTensor contructor :  size = 0 rank =  0
default DTensor contructor :  size = 0 rank =  0
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  0 name = DColumnLinear_bias


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  1 name = DColumnLinear_bias


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = DRowLinear_weight


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = DRowLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_bias


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_bias
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = Input
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = DColumnLinear_weight


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  0 name = DColumnLinear_bias


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  1 name = DColumnLinear_bias


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = DRowLinear_weight


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = DRowLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_bias


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_bias
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = full_weight_init
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  0 name = DColumnLinear_bias


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  1 name = DColumnLinear_bias


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = DRowLinear_weight


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = DRowLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_bias


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_bias
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = Input
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = DColumnLinear_weight


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  0 name = DColumnLinear_bias


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  1 name = DColumnLinear_bias


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = DRowLinear_weight


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = DRowLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_bias


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_bias
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = DColumnLinear_weight
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  0 name = DColumnLinear_bias


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  1 name = DColumnLinear_bias


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = DRowLinear_weight


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = DRowLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_bias


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_bias
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = full_weight_init
default DTensor contructor :  size = 0 rank =  0


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  0 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = Input


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 768 ] 


 size = 18874368 rank =  1 name = DColumnLinear_weight


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  0 name = DColumnLinear_bias


 shape = [ 8 , 1024 ] 


 size = 25165824 rank =  1 name = DColumnLinear_bias


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  0 name = DRowLinear_weight


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = full_weight_init


 shape = [ 8 , 3072 ] 


 size = 18874368 rank =  1 name = DRowLinear_weight


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_bias


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_bias


 shape = [ 1 , 1024 ] 


 size = 1024 rank =  0 name = PositionIndices


 B = 8




 T = 1024




 C = 768




 Dpos global shape = [ 1 , 1024 ] 




 shape = [ 8 , 1024 ] 


 size = 8192 rank =  0 name = InputIndices
CUDA0


 shape = [ 1 , 1024 ] 


 size = 1024 rank =  1 name = PositionIndices


 B = 8




 T = 1024




 C = 768




 Dpos global shape = [ 1 , 1024 ] 




 shape = [ 8 , 1024 ] 


 size = 8192 rank =  1 name = InputIndices
CUDA1
  [GPT Constructor] weight initializtion done





 Completed 





Number of parameters: 473098752
found 5 shards for split train
found 1 shards for split val

Starting training...
Saving logs to: Training__log274.csv

=== START OF STEP 0 ===

=== ACTIVE TENSOR REGISTRY (48 tensors) ===
Tensor 0x5ea29cb423c0 | Refcount: 1 | Device: 0 | Shape: [25152,768] | GradFn: None/Null | 
Tensor 0x5ea2a0f68780 | Refcount: 1 | Device: 0 | Shape: [1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a16b59e0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b5dc0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b5e60 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b6430 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b6700 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a16b77a0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a16b9e40 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a16bacc0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a16bc110 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a16be370 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1711d50 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a1714020 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a17151b0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1715820 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a1715df0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1716bb0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a171e960 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1720c50 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a17210b0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1722db0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a17239e0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1723c20 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1727060 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1728c20 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a172b250 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a172b3b0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a172e760 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a17304f0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1732b90 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1734e80 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a17352e0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1737030 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a1737c60 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1738c00 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a173b0f0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a173cc70 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a173ef60 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a173f3c0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a17410c0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a1741690 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1742650 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a17427b0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1745da0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a17481e0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a17484f0 | Refcount: 1 | Device: 0 | Shape: [8,1024] | Autograd: None | 
Tensor 0x5ea2a174ada0 | Refcount: 1 | Device: 0 | Shape: [1,1024] | Autograd: None | 
==========================================

Val step 0 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


  [GPT Constructor] weight initializtion done





 Completed 






=== START OF STEP 0 ===

=== ACTIVE TENSOR REGISTRY (48 tensors) ===
Tensor 0x641e47b98170 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4bfabca0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4bfbe520 | Refcount: 1 | Device: 1 | Shape: [1024,768] | GradFn: None/Null | 
Tensor 0x641e4c70ad80 | Refcount: 1 | Device: 1 | Shape: [25152,768] | GradFn: None/Null | 
Tensor 0x641e4c70d620 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c70d700 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c70d780 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c70ff50 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c7109c0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c7116d0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c712b20 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c715200 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c729ea0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c72bc00 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c72cec0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c72dcf0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c731d30 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c733140 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c734d00 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c737340 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c7399c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c739c90 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c73a300 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c73a380 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c73d430 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c73eff0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c741630 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c741790 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c7431b0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c743440 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c743ba0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c744ab0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c745f00 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c747ac0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c74a260 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c74be90 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c74d000 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c74e5e0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c74ee90 | Refcount: 1 | Device: 1 | Shape: [8,1024] | Autograd: None | 
Tensor 0x641e4c750400 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c752a80 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c756e50 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c757fc0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c759e90 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c75b9f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c75de40 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c7608d0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c761030 | Refcount: 1 | Device: 1 | Shape: [1,1024] | Autograd: None | 
==========================================



 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 2306MB, Free: 9603MB, Tensors: 56


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 2306MB, Free: 9603MB, Tensors: 58
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 2727MB, Free: 9173MB, Tensors: 56


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 2727MB, Free: 9173MB, Tensors: 58
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 2306MB, Free: 9603MB, Tensors: 59
[MEM] After tok+pos add - Used: 2727MB, Free: 9173MB, Tensors: 59


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 2668MB, Free: 9241MB, Tensors: 69
[MEM] After MLP block 0 - Used: 3121MB, Free: 8779MB, Tensors: 69


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 2988MB, Free: 8921MB, Tensors: 79
[MEM] After MLP block 1 - Used: 3473MB, Free: 8427MB, Tensors: 79


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 3340MB, Free: 8569MB, Tensors: 89
[MEM] After MLP block 2 - Used: 3825MB, Free: 8075MB, Tensors: 89


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 3724MB, Free: 8185MB, Tensors: 99
[MEM] After MLP block 3 - Used: 4177MB, Free: 7723MB, Tensors: 99


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 4076MB, Free: 7833MB, Tensors: 109
[MEM] After MLP block 4 - Used: 4561MB, Free: 7339MB, Tensors: 109


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4913MB, Free: 6987MB, Tensors: 119
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4913MB, Free: 6987MB, Tensors: 119
[MEM] After MLP block 5 - Used: 4442MB, Free: 7467MB, Tensors: 119
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4442MB, Free: 7467MB, Tensors: 119


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = ln_f_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = ln_f_output
[MEM] After ln_f - Used: 4945MB, Free: 6955MB, Tensors: 124
[MEM] Before lm_head - Used: 4945MB, Free: 6955MB, Tensors: 124
[MEM] After ln_f - Used: 4474MB, Free: 7435MB, Tensors: 124
[MEM] Before lm_head - Used: 4474MB, Free: 7435MB, Tensors: 124


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = logits


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = logits
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 126
  forward done


 shape = [ 8 , 1024 ] 


 size = 8192 rank =  0 name = global_max


 shape = [ 8 , 1024 ] 


 size = 8192 rank =  0 name = global_sum_exp


 shape = [ 8 , 1024 ] 


 size = 8192 rank =  0 name = global_target_logit
[MEM] After lm_head - Used: 5733MB, Free: 6167MB, Tensors: 126


 shape = [ 8 , 1024 ] 


 size = 8192 rank =  1 name = global_max


 shape = [ 8 , 1024 ] 


 size = 8192 rank =  1 name = global_sum_exp


 shape = [ 8 , 1024 ] 


 size = 8192 rank =  1 name = global_target_logit
  cross_entropy done
Val step 1 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 120


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 122
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4612MB, Free: 7288MB, Tensors: 120


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4612MB, Free: 7288MB, Tensors: 122
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 123
[MEM] After tok+pos add - Used: 4644MB, Free: 7256MB, Tensors: 123


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 134
[MEM] After MLP block 0 - Used: 5028MB, Free: 6872MB, Tensors: 134


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 145
[MEM] After MLP block 1 - Used: 5412MB, Free: 6488MB, Tensors: 145


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 156
[MEM] After MLP block 2 - Used: 5794MB, Free: 6106MB, Tensors: 156


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 167
[MEM] After MLP block 3 - Used: 6178MB, Free: 5722MB, Tensors: 167


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 178
[MEM] After MLP block 4 - Used: 6562MB, Free: 5338MB, Tensors: 178


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 122
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 122
[MEM] After MLP block 5 - Used: 5058MB, Free: 6842MB, Tensors: 122
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5058MB, Free: 6842MB, Tensors: 122
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 127
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 127
[MEM] After ln_f - Used: 5058MB, Free: 6842MB, Tensors: 127
[MEM] Before lm_head - Used: 5058MB, Free: 6842MB, Tensors: 127


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 129
  forward done
[MEM] After lm_head - Used: 5818MB, Free: 6082MB, Tensors: 129
  cross_entropy done
Val step 2 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 122


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 124
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4761MB, Free: 7138MB, Tensors: 122


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4761MB, Free: 7138MB, Tensors: 124
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 125
[MEM] After tok+pos add - Used: 4761MB, Free: 7138MB, Tensors: 125


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 136
[MEM] After MLP block 0 - Used: 5081MB, Free: 6818MB, Tensors: 136


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 147
[MEM] After MLP block 1 - Used: 5465MB, Free: 6434MB, Tensors: 147


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 158
[MEM] After MLP block 2 - Used: 5849MB, Free: 6050MB, Tensors: 158


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 169
[MEM] After MLP block 3 - Used: 6233MB, Free: 5666MB, Tensors: 169


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 180
[MEM] After MLP block 4 - Used: 6585MB, Free: 5314MB, Tensors: 180


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 124
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 124
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 129
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 129
[MEM] After MLP block 5 - Used: 4921MB, Free: 6978MB, Tensors: 124
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4921MB, Free: 6978MB, Tensors: 124
[MEM] After ln_f - Used: 4953MB, Free: 6946MB, Tensors: 129
[MEM] Before lm_head - Used: 4953MB, Free: 6946MB, Tensors: 129


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 131
  forward done
[MEM] After lm_head - Used: 5721MB, Free: 6178MB, Tensors: 131
  cross_entropy done
Val step 3 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 124


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 126
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4601MB, Free: 7298MB, Tensors: 124


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4601MB, Free: 7298MB, Tensors: 126
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 127
[MEM] After tok+pos add - Used: 4633MB, Free: 7266MB, Tensors: 127


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 138
[MEM] After MLP block 0 - Used: 4999MB, Free: 6901MB, Tensors: 138


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 149
[MEM] After MLP block 1 - Used: 5383MB, Free: 6517MB, Tensors: 149


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 160
[MEM] After MLP block 2 - Used: 5767MB, Free: 6133MB, Tensors: 160


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 171
[MEM] After MLP block 3 - Used: 6151MB, Free: 5749MB, Tensors: 171


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 182
[MEM] After MLP block 4 - Used: 6535MB, Free: 5365MB, Tensors: 182


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 126
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 126
[MEM] After MLP block 5 - Used: 5031MB, Free: 6869MB, Tensors: 126
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5031MB, Free: 6869MB, Tensors: 126
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 131
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 131
[MEM] After ln_f - Used: 5031MB, Free: 6869MB, Tensors: 131
[MEM] Before lm_head - Used: 5031MB, Free: 6869MB, Tensors: 131


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 133
  forward done
[MEM] After lm_head - Used: 5799MB, Free: 6101MB, Tensors: 133
  cross_entropy done
Val step 4 - starting
  batch loaded


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 126


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 128
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4743MB, Free: 7157MB, Tensors: 126


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4743MB, Free: 7157MB, Tensors: 128
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 129
[MEM] After tok+pos add - Used: 4743MB, Free: 7157MB, Tensors: 129


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 140
[MEM] After MLP block 0 - Used: 5063MB, Free: 6837MB, Tensors: 140


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 151
[MEM] After MLP block 1 - Used: 5447MB, Free: 6453MB, Tensors: 151


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 162
[MEM] After MLP block 2 - Used: 5831MB, Free: 6069MB, Tensors: 162


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 173
[MEM] After MLP block 3 - Used: 6215MB, Free: 5685MB, Tensors: 173


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 184
[MEM] After MLP block 4 - Used: 6567MB, Free: 5333MB, Tensors: 184


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 128
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 128
[MEM] After MLP block 5 - Used: 4903MB, Free: 6997MB, Tensors: 128
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4903MB, Free: 6997MB, Tensors: 128
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 133
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 133
[MEM] After ln_f - Used: 4935MB, Free: 6965MB, Tensors: 133
[MEM] Before lm_head - Used: 4935MB, Free: 6965MB, Tensors: 133


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 135
  forward done
[MEM] After lm_head - Used: 5703MB, Free: 6197MB, Tensors: 135
  cross_entropy done
Val step 5 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 128


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 130
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4583MB, Free: 7317MB, Tensors: 128


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4583MB, Free: 7317MB, Tensors: 130
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 131


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output
[MEM] After tok+pos add - Used: 4608MB, Free: 7292MB, Tensors: 131


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 142
[MEM] After MLP block 0 - Used: 4992MB, Free: 6908MB, Tensors: 142


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 153
[MEM] After MLP block 1 - Used: 5376MB, Free: 6524MB, Tensors: 153


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 164
[MEM] After MLP block 2 - Used: 5760MB, Free: 6140MB, Tensors: 164


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 175
[MEM] After MLP block 3 - Used: 6144MB, Free: 5756MB, Tensors: 175


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 186
[MEM] After MLP block 4 - Used: 6528MB, Free: 5372MB, Tensors: 186


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 130
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 130
[MEM] After MLP block 5 - Used: 5024MB, Free: 6876MB, Tensors: 130
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5024MB, Free: 6876MB, Tensors: 130
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 135
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 135
[MEM] After ln_f - Used: 5024MB, Free: 6876MB, Tensors: 135
[MEM] Before lm_head - Used: 5024MB, Free: 6876MB, Tensors: 135


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 137
  forward done
[MEM] After lm_head - Used: 5792MB, Free: 6108MB, Tensors: 137
  cross_entropy done
Val step 6 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 130


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 132
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4736MB, Free: 7164MB, Tensors: 130


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4736MB, Free: 7164MB, Tensors: 132
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 133
[MEM] After tok+pos add - Used: 4736MB, Free: 7164MB, Tensors: 133


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4697MB, Free: 7212MB, Tensors: 144
[MEM] After MLP block 0 - Used: 5056MB, Free: 6844MB, Tensors: 144


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 155
[MEM] After MLP block 1 - Used: 5440MB, Free: 6460MB, Tensors: 155


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 166
[MEM] After MLP block 2 - Used: 5824MB, Free: 6076MB, Tensors: 166


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 177
[MEM] After MLP block 3 - Used: 6208MB, Free: 5692MB, Tensors: 177


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 188
[MEM] After MLP block 4 - Used: 6547MB, Free: 5353MB, Tensors: 188


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 132
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 132
[MEM] After MLP block 5 - Used: 4883MB, Free: 7017MB, Tensors: 132
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4883MB, Free: 7017MB, Tensors: 132
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 137
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 137
[MEM] After ln_f - Used: 4915MB, Free: 6985MB, Tensors: 137
[MEM] Before lm_head - Used: 4915MB, Free: 6985MB, Tensors: 137


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 139
  forward done
[MEM] After lm_head - Used: 5683MB, Free: 6217MB, Tensors: 139
  cross_entropy done
Val step 7 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 132


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 134
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4538MB, Free: 7362MB, Tensors: 132


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4538MB, Free: 7362MB, Tensors: 134
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 135
[MEM] After tok+pos add - Used: 4570MB, Free: 7330MB, Tensors: 135


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 146
[MEM] After MLP block 0 - Used: 4954MB, Free: 6946MB, Tensors: 146


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 157
[MEM] After MLP block 1 - Used: 5338MB, Free: 6562MB, Tensors: 157


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 168
[MEM] After MLP block 2 - Used: 5722MB, Free: 6178MB, Tensors: 168


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 179
[MEM] After MLP block 3 - Used: 6106MB, Free: 5794MB, Tensors: 179


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 190
[MEM] After MLP block 4 - Used: 6490MB, Free: 5410MB, Tensors: 190


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 134
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 134
[MEM] After MLP block 5 - Used: 4986MB, Free: 6914MB, Tensors: 134
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4986MB, Free: 6914MB, Tensors: 134
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 139
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 139
[MEM] After ln_f - Used: 4986MB, Free: 6914MB, Tensors: 139
[MEM] Before lm_head - Used: 4986MB, Free: 6914MB, Tensors: 139


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 141
  forward done
[MEM] After lm_head - Used: 5754MB, Free: 6146MB, Tensors: 141
  cross_entropy done
Val step 8 - starting
  batch loaded


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 134


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 136
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4693MB, Free: 7207MB, Tensors: 134


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4693MB, Free: 7207MB, Tensors: 136
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 137


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output
[MEM] After tok+pos add - Used: 4693MB, Free: 7207MB, Tensors: 137


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 148
[MEM] After MLP block 0 - Used: 5013MB, Free: 6887MB, Tensors: 148


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 159
[MEM] After MLP block 1 - Used: 5397MB, Free: 6503MB, Tensors: 159


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 170
[MEM] After MLP block 2 - Used: 5781MB, Free: 6119MB, Tensors: 170


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 181
[MEM] After MLP block 3 - Used: 6165MB, Free: 5735MB, Tensors: 181


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 192
[MEM] After MLP block 4 - Used: 6517MB, Free: 5383MB, Tensors: 192


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 136
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 136
[MEM] After MLP block 5 - Used: 4853MB, Free: 7047MB, Tensors: 136
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4853MB, Free: 7047MB, Tensors: 136
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 141
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 141
[MEM] After ln_f - Used: 4885MB, Free: 7015MB, Tensors: 141
[MEM] Before lm_head - Used: 4885MB, Free: 7015MB, Tensors: 141


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 143
  forward done
[MEM] After lm_head - Used: 5653MB, Free: 6247MB, Tensors: 143
  cross_entropy done
Val step 9 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 136


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 138
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4533MB, Free: 7367MB, Tensors: 136


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4533MB, Free: 7367MB, Tensors: 138
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 139
[MEM] After tok+pos add - Used: 4565MB, Free: 7335MB, Tensors: 139


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 150
[MEM] After MLP block 0 - Used: 4949MB, Free: 6951MB, Tensors: 150


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 161
[MEM] After MLP block 1 - Used: 5333MB, Free: 6567MB, Tensors: 161


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 172
[MEM] After MLP block 2 - Used: 5717MB, Free: 6183MB, Tensors: 172


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 183
[MEM] After MLP block 3 - Used: 6101MB, Free: 5799MB, Tensors: 183


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 194
[MEM] After MLP block 4 - Used: 6485MB, Free: 5415MB, Tensors: 194


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 138
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 138
[MEM] After MLP block 5 - Used: 4981MB, Free: 6919MB, Tensors: 138
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4981MB, Free: 6919MB, Tensors: 138
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 143
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 143
[MEM] After ln_f - Used: 4981MB, Free: 6919MB, Tensors: 143
[MEM] Before lm_head - Used: 4981MB, Free: 6919MB, Tensors: 143


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 145
  forward done
[MEM] After lm_head - Used: 5749MB, Free: 6151MB, Tensors: 145
  cross_entropy done
Val step 10 - starting
  batch loaded


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 138


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 140
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4693MB, Free: 7207MB, Tensors: 138


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4693MB, Free: 7207MB, Tensors: 140
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 141
[MEM] After tok+pos add - Used: 4693MB, Free: 7207MB, Tensors: 141


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 152
[MEM] After MLP block 0 - Used: 5013MB, Free: 6887MB, Tensors: 152


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 163
[MEM] After MLP block 1 - Used: 5397MB, Free: 6503MB, Tensors: 163


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 174
[MEM] After MLP block 2 - Used: 5781MB, Free: 6119MB, Tensors: 174


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 185
[MEM] After MLP block 3 - Used: 6165MB, Free: 5735MB, Tensors: 185


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 196
[MEM] After MLP block 4 - Used: 6518MB, Free: 5382MB, Tensors: 196


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 140
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 140
[MEM] After MLP block 5 - Used: 4854MB, Free: 7046MB, Tensors: 140
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4854MB, Free: 7046MB, Tensors: 140
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 145
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 145
[MEM] After ln_f - Used: 4886MB, Free: 7014MB, Tensors: 145
[MEM] Before lm_head - Used: 4886MB, Free: 7014MB, Tensors: 145


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 147
  forward done
[MEM] After lm_head - Used: 5654MB, Free: 6246MB, Tensors: 147
  cross_entropy done
Val step 11 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 140


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 142
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4529MB, Free: 7371MB, Tensors: 140


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4529MB, Free: 7371MB, Tensors: 142
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 143
[MEM] After tok+pos add - Used: 4561MB, Free: 7339MB, Tensors: 143


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 154
[MEM] After MLP block 0 - Used: 4945MB, Free: 6955MB, Tensors: 154


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 165
[MEM] After MLP block 1 - Used: 5329MB, Free: 6571MB, Tensors: 165


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 176
[MEM] After MLP block 2 - Used: 5713MB, Free: 6187MB, Tensors: 176


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 187
[MEM] After MLP block 3 - Used: 6097MB, Free: 5803MB, Tensors: 187


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 198
[MEM] After MLP block 4 - Used: 6481MB, Free: 5419MB, Tensors: 198


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 142
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 142
[MEM] After MLP block 5 - Used: 4977MB, Free: 6923MB, Tensors: 142
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4977MB, Free: 6923MB, Tensors: 142
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 147
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 147
[MEM] After ln_f - Used: 4977MB, Free: 6923MB, Tensors: 147
[MEM] Before lm_head - Used: 4977MB, Free: 6923MB, Tensors: 147


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 149
  forward done
[MEM] After lm_head - Used: 5745MB, Free: 6155MB, Tensors: 149
  cross_entropy done
Val step 12 - starting
  batch loaded


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 142


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 144
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4689MB, Free: 7211MB, Tensors: 142


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4689MB, Free: 7211MB, Tensors: 144
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 145


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output
[MEM] After tok+pos add - Used: 4689MB, Free: 7211MB, Tensors: 145


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4697MB, Free: 7212MB, Tensors: 156
[MEM] After MLP block 0 - Used: 5009MB, Free: 6891MB, Tensors: 156


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 167
[MEM] After MLP block 1 - Used: 5393MB, Free: 6507MB, Tensors: 167


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 178
[MEM] After MLP block 2 - Used: 5777MB, Free: 6123MB, Tensors: 178


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 189
[MEM] After MLP block 3 - Used: 6161MB, Free: 5739MB, Tensors: 189


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 200
[MEM] After MLP block 4 - Used: 6513MB, Free: 5387MB, Tensors: 200


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 144
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 144
[MEM] After MLP block 5 - Used: 4846MB, Free: 7054MB, Tensors: 144
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4846MB, Free: 7054MB, Tensors: 144
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 149
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 149
[MEM] After ln_f - Used: 4878MB, Free: 7022MB, Tensors: 149
[MEM] Before lm_head - Used: 4878MB, Free: 7022MB, Tensors: 149


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5646MB, Free: 6254MB, Tensors: 151
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 151
  forward done
  cross_entropy done
Val step 13 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 144


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 146
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4526MB, Free: 7374MB, Tensors: 144


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4526MB, Free: 7374MB, Tensors: 146
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 147
[MEM] After tok+pos add - Used: 4558MB, Free: 7342MB, Tensors: 147


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 158
[MEM] After MLP block 0 - Used: 4942MB, Free: 6958MB, Tensors: 158


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 169
[MEM] After MLP block 1 - Used: 5326MB, Free: 6574MB, Tensors: 169


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 180
[MEM] After MLP block 2 - Used: 5710MB, Free: 6190MB, Tensors: 180


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 191
[MEM] After MLP block 3 - Used: 6094MB, Free: 5806MB, Tensors: 191


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 202
[MEM] After MLP block 4 - Used: 6478MB, Free: 5422MB, Tensors: 202


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 146
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 146
[MEM] After MLP block 5 - Used: 4974MB, Free: 6926MB, Tensors: 146
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4974MB, Free: 6926MB, Tensors: 146
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 151
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 151
[MEM] After ln_f - Used: 4974MB, Free: 6926MB, Tensors: 151
[MEM] Before lm_head - Used: 4974MB, Free: 6926MB, Tensors: 151


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 153
  forward done
[MEM] After lm_head - Used: 5742MB, Free: 6158MB, Tensors: 153
  cross_entropy done
Val step 14 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 146


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 148
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4685MB, Free: 7214MB, Tensors: 146


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4685MB, Free: 7214MB, Tensors: 148
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 149
[MEM] After tok+pos add - Used: 4685MB, Free: 7214MB, Tensors: 149


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 160
[MEM] After MLP block 0 - Used: 5005MB, Free: 6894MB, Tensors: 160


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 171
[MEM] After MLP block 1 - Used: 5389MB, Free: 6510MB, Tensors: 171


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 182
[MEM] After MLP block 2 - Used: 5773MB, Free: 6126MB, Tensors: 182


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 193
[MEM] After MLP block 3 - Used: 6157MB, Free: 5742MB, Tensors: 193


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 204
[MEM] After MLP block 4 - Used: 6509MB, Free: 5390MB, Tensors: 204


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 148
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 148
[MEM] After MLP block 5 - Used: 4845MB, Free: 7054MB, Tensors: 148
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4845MB, Free: 7054MB, Tensors: 148
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 153
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 153
[MEM] After ln_f - Used: 4877MB, Free: 7022MB, Tensors: 153
[MEM] Before lm_head - Used: 4877MB, Free: 7022MB, Tensors: 153


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 155
  forward done
[MEM] After lm_head - Used: 5645MB, Free: 6254MB, Tensors: 155
  cross_entropy done
Val step 15 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 148


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 150
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4524MB, Free: 7376MB, Tensors: 148


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4524MB, Free: 7376MB, Tensors: 150
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 151
[MEM] After tok+pos add - Used: 4556MB, Free: 7344MB, Tensors: 151


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 162
[MEM] After MLP block 0 - Used: 4940MB, Free: 6960MB, Tensors: 162


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 173
[MEM] After MLP block 1 - Used: 5324MB, Free: 6576MB, Tensors: 173


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 184
[MEM] After MLP block 2 - Used: 5708MB, Free: 6192MB, Tensors: 184


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 195
[MEM] After MLP block 3 - Used: 6092MB, Free: 5808MB, Tensors: 195


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 206
[MEM] After MLP block 4 - Used: 6476MB, Free: 5424MB, Tensors: 206


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 150
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 150
[MEM] After MLP block 5 - Used: 4972MB, Free: 6928MB, Tensors: 150
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4972MB, Free: 6928MB, Tensors: 150
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 155
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 155
[MEM] After ln_f - Used: 4972MB, Free: 6928MB, Tensors: 155
[MEM] Before lm_head - Used: 4972MB, Free: 6928MB, Tensors: 155


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 157
  forward done
[MEM] After lm_head - Used: 5740MB, Free: 6160MB, Tensors: 157
  cross_entropy done
Val step 16 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 150


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 152
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4684MB, Free: 7216MB, Tensors: 150


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4684MB, Free: 7216MB, Tensors: 152
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 153
[MEM] After tok+pos add - Used: 4684MB, Free: 7216MB, Tensors: 153


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 164
[MEM] After MLP block 0 - Used: 5004MB, Free: 6896MB, Tensors: 164


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 175
[MEM] After MLP block 1 - Used: 5388MB, Free: 6512MB, Tensors: 175


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 186
[MEM] After MLP block 2 - Used: 5772MB, Free: 6128MB, Tensors: 186


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 197
[MEM] After MLP block 3 - Used: 6156MB, Free: 5744MB, Tensors: 197


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 208
[MEM] After MLP block 4 - Used: 6508MB, Free: 5392MB, Tensors: 208


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 152
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 152
[MEM] After MLP block 5 - Used: 4844MB, Free: 7056MB, Tensors: 152
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4844MB, Free: 7056MB, Tensors: 152
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 157
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 157
[MEM] After ln_f - Used: 4876MB, Free: 7024MB, Tensors: 157
[MEM] Before lm_head - Used: 4876MB, Free: 7024MB, Tensors: 157


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 159
  forward done
[MEM] After lm_head - Used: 5644MB, Free: 6256MB, Tensors: 159
  cross_entropy done
Val step 17 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 152


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 154
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4524MB, Free: 7376MB, Tensors: 152


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4524MB, Free: 7376MB, Tensors: 154
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 155
[MEM] After tok+pos add - Used: 4556MB, Free: 7344MB, Tensors: 155


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 166
[MEM] After MLP block 0 - Used: 4940MB, Free: 6960MB, Tensors: 166


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 177
[MEM] After MLP block 1 - Used: 5324MB, Free: 6576MB, Tensors: 177


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 188
[MEM] After MLP block 2 - Used: 5708MB, Free: 6192MB, Tensors: 188


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 199
[MEM] After MLP block 3 - Used: 6092MB, Free: 5808MB, Tensors: 199


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 210
[MEM] After MLP block 4 - Used: 6476MB, Free: 5424MB, Tensors: 210


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 154
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 154
[MEM] After MLP block 5 - Used: 4972MB, Free: 6928MB, Tensors: 154
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4972MB, Free: 6928MB, Tensors: 154
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 159
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 159
[MEM] After ln_f - Used: 4972MB, Free: 6928MB, Tensors: 159
[MEM] Before lm_head - Used: 4972MB, Free: 6928MB, Tensors: 159


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 161
  forward done
[MEM] After lm_head - Used: 5740MB, Free: 6160MB, Tensors: 161
  cross_entropy done
Val step 18 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 154


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 156
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4684MB, Free: 7216MB, Tensors: 154


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4684MB, Free: 7216MB, Tensors: 156
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 157
[MEM] After tok+pos add - Used: 4684MB, Free: 7216MB, Tensors: 157


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4697MB, Free: 7212MB, Tensors: 168
[MEM] After MLP block 0 - Used: 5004MB, Free: 6896MB, Tensors: 168


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 179
[MEM] After MLP block 1 - Used: 5388MB, Free: 6512MB, Tensors: 179


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 190
[MEM] After MLP block 2 - Used: 5772MB, Free: 6128MB, Tensors: 190


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 201
[MEM] After MLP block 3 - Used: 6156MB, Free: 5744MB, Tensors: 201


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 212
[MEM] After MLP block 4 - Used: 6508MB, Free: 5392MB, Tensors: 212


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 156
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 156
[MEM] After MLP block 5 - Used: 4844MB, Free: 7056MB, Tensors: 156
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4844MB, Free: 7056MB, Tensors: 156
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 161
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 161
[MEM] After ln_f - Used: 4876MB, Free: 7024MB, Tensors: 161
[MEM] Before lm_head - Used: 4876MB, Free: 7024MB, Tensors: 161


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 163
  forward done
[MEM] After lm_head - Used: 5644MB, Free: 6256MB, Tensors: 163
  cross_entropy done
Val step 19 - starting
  batch loaded
  x.to done
  y.to done


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4217MB, Free: 7692MB, Tensors: 156


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4217MB, Free: 7692MB, Tensors: 158
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4524MB, Free: 7376MB, Tensors: 156


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4524MB, Free: 7376MB, Tensors: 158
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4249MB, Free: 7660MB, Tensors: 159
[MEM] After tok+pos add - Used: 4556MB, Free: 7344MB, Tensors: 159


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4633MB, Free: 7276MB, Tensors: 170
[MEM] After MLP block 0 - Used: 4940MB, Free: 6960MB, Tensors: 170


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5017MB, Free: 6892MB, Tensors: 181
[MEM] After MLP block 1 - Used: 5324MB, Free: 6576MB, Tensors: 181


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5401MB, Free: 6508MB, Tensors: 192
[MEM] After MLP block 2 - Used: 5708MB, Free: 6192MB, Tensors: 192


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5785MB, Free: 6124MB, Tensors: 203
[MEM] After MLP block 3 - Used: 6092MB, Free: 5808MB, Tensors: 203


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6169MB, Free: 5740MB, Tensors: 214
[MEM] After MLP block 4 - Used: 6476MB, Free: 5424MB, Tensors: 214


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4633MB, Free: 7276MB, Tensors: 158
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4633MB, Free: 7276MB, Tensors: 158
[MEM] After MLP block 5 - Used: 4972MB, Free: 6928MB, Tensors: 158
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4972MB, Free: 6928MB, Tensors: 158
[MEM] After ln_f - Used: 4665MB, Free: 7244MB, Tensors: 163
[MEM] Before lm_head - Used: 4665MB, Free: 7244MB, Tensors: 163
[MEM] After ln_f - Used: 4972MB, Free: 6928MB, Tensors: 163
[MEM] Before lm_head - Used: 4972MB, Free: 6928MB, Tensors: 163


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5433MB, Free: 6476MB, Tensors: 165
  forward done
[MEM] After lm_head - Used: 5740MB, Free: 6160MB, Tensors: 165
  cross_entropy done
validation loss: 10.8258

 microstep = 0

 microstep = 0
[MEM] Start of micro_step 0 - Used: 4345MB, Free: 7564MB, Tensors: 151


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


[MEM] Start of micro_step 0 - Used: 4684MB, Free: 7216MB, Tensors: 151


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4345MB, Free: 7564MB, Tensors: 159


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 4345MB, Free: 7564MB, Tensors: 161
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 4684MB, Free: 7216MB, Tensors: 159


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 4684MB, Free: 7216MB, Tensors: 161
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 4345MB, Free: 7564MB, Tensors: 162
[MEM] After tok+pos add - Used: 4684MB, Free: 7216MB, Tensors: 162


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 4729MB, Free: 7180MB, Tensors: 173
[MEM] After MLP block 0 - Used: 5004MB, Free: 6896MB, Tensors: 173


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 5081MB, Free: 6828MB, Tensors: 184
[MEM] After MLP block 1 - Used: 5388MB, Free: 6512MB, Tensors: 184


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 5433MB, Free: 6476MB, Tensors: 195
[MEM] After MLP block 2 - Used: 5772MB, Free: 6128MB, Tensors: 195


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 5817MB, Free: 6092MB, Tensors: 206
[MEM] After MLP block 3 - Used: 6156MB, Free: 5744MB, Tensors: 206


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 6201MB, Free: 5708MB, Tensors: 217
[MEM] After MLP block 4 - Used: 6508MB, Free: 5392MB, Tensors: 217


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 4537MB, Free: 7372MB, Tensors: 161
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4537MB, Free: 7372MB, Tensors: 161
[MEM] After MLP block 5 - Used: 4844MB, Free: 7056MB, Tensors: 161
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 4844MB, Free: 7056MB, Tensors: 161
[MEM] After ln_f - Used: 4569MB, Free: 7340MB, Tensors: 166
[MEM] Before lm_head - Used: 4569MB, Free: 7340MB, Tensors: 166
[MEM] After ln_f - Used: 4876MB, Free: 7024MB, Tensors: 166
[MEM] Before lm_head - Used: 4876MB, Free: 7024MB, Tensors: 166


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 5337MB, Free: 6572MB, Tensors: 168
[MEM] After lm_head - Used: 5644MB, Free: 6256MB, Tensors: 168
[MEM] After backward, before release - Used: 4345MB, Free: 7564MB, Tensors: 120
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After backward, before release - Used: 4588MB, Free: 7312MB, Tensors: 120
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After all releases - Used: 3321MB, Free: 8588MB, Tensors: 108
Micro 0 Active Tensors: 108

 microstep = 1
[MEM] Start of micro_step 1 - Used: 3321MB, Free: 8588MB, Tensors: 108


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


[MEM] After all releases - Used: 3660MB, Free: 8240MB, Tensors: 108
Micro 0 Active Tensors: 108

 microstep = 1
[MEM] Start of micro_step 1 - Used: 3660MB, Free: 8240MB, Tensors: 108


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 3321MB, Free: 8588MB, Tensors: 116


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 3321MB, Free: 8588MB, Tensors: 118
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 3660MB, Free: 8240MB, Tensors: 116


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 3660MB, Free: 8240MB, Tensors: 118
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 3321MB, Free: 8588MB, Tensors: 119


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output
[MEM] After tok+pos add - Used: 3660MB, Free: 8240MB, Tensors: 119


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 3609MB, Free: 8300MB, Tensors: 130
[MEM] After MLP block 0 - Used: 3916MB, Free: 7984MB, Tensors: 130


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 3929MB, Free: 7980MB, Tensors: 141
[MEM] After MLP block 1 - Used: 4236MB, Free: 7664MB, Tensors: 141


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 4249MB, Free: 7660MB, Tensors: 152
[MEM] After MLP block 2 - Used: 4556MB, Free: 7344MB, Tensors: 152


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 4569MB, Free: 7340MB, Tensors: 163
[MEM] After MLP block 3 - Used: 4844MB, Free: 7056MB, Tensors: 163


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 4921MB, Free: 6988MB, Tensors: 174
[MEM] After MLP block 4 - Used: 5196MB, Free: 6704MB, Tensors: 174


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 5241MB, Free: 6668MB, Tensors: 185
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5241MB, Free: 6668MB, Tensors: 185
[MEM] After MLP block 5 - Used: 5548MB, Free: 6352MB, Tensors: 185
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5548MB, Free: 6352MB, Tensors: 185
[MEM] After ln_f - Used: 5273MB, Free: 6636MB, Tensors: 190
[MEM] Before lm_head - Used: 5273MB, Free: 6636MB, Tensors: 190
[MEM] After ln_f - Used: 5580MB, Free: 6320MB, Tensors: 190
[MEM] Before lm_head - Used: 5580MB, Free: 6320MB, Tensors: 190


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 6073MB, Free: 5836MB, Tensors: 192
[MEM] After lm_head - Used: 6348MB, Free: 5552MB, Tensors: 192
[MEM] After backward, before release - Used: 4281MB, Free: 7628MB, Tensors: 122
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After backward, before release - Used: 4620MB, Free: 7280MB, Tensors: 122
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After all releases - Used: 3321MB, Free: 8588MB, Tensors: 110
Micro 1 Active Tensors: 110

 microstep = 2
[MEM] Start of micro_step 2 - Used: 3321MB, Free: 8588MB, Tensors: 110


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


[MEM] After all releases - Used: 3660MB, Free: 8240MB, Tensors: 110
Micro 1 Active Tensors: 110

 microstep = 2
[MEM] Start of micro_step 2 - Used: 3660MB, Free: 8240MB, Tensors: 110


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 3321MB, Free: 8588MB, Tensors: 118


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 3321MB, Free: 8588MB, Tensors: 120
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 3660MB, Free: 8240MB, Tensors: 118


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 3660MB, Free: 8240MB, Tensors: 120
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 3321MB, Free: 8588MB, Tensors: 121
[MEM] After tok+pos add - Used: 3660MB, Free: 8240MB, Tensors: 121


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 3609MB, Free: 8300MB, Tensors: 132
[MEM] After MLP block 0 - Used: 3916MB, Free: 7984MB, Tensors: 132


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 3929MB, Free: 7980MB, Tensors: 143
[MEM] After MLP block 1 - Used: 4236MB, Free: 7664MB, Tensors: 143


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 4249MB, Free: 7660MB, Tensors: 154
[MEM] After MLP block 2 - Used: 4556MB, Free: 7344MB, Tensors: 154


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 4537MB, Free: 7372MB, Tensors: 165
[MEM] After MLP block 3 - Used: 4844MB, Free: 7056MB, Tensors: 165


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 4921MB, Free: 6988MB, Tensors: 176
[MEM] After MLP block 4 - Used: 5196MB, Free: 6704MB, Tensors: 176


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 5241MB, Free: 6668MB, Tensors: 187
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5241MB, Free: 6668MB, Tensors: 187
[MEM] After MLP block 5 - Used: 5548MB, Free: 6352MB, Tensors: 187
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5548MB, Free: 6352MB, Tensors: 187
[MEM] After ln_f - Used: 5273MB, Free: 6636MB, Tensors: 192
[MEM] Before lm_head - Used: 5273MB, Free: 6636MB, Tensors: 192
[MEM] After ln_f - Used: 5580MB, Free: 6320MB, Tensors: 192
[MEM] Before lm_head - Used: 5580MB, Free: 6320MB, Tensors: 192


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 6073MB, Free: 5836MB, Tensors: 194
[MEM] After lm_head - Used: 6348MB, Free: 5552MB, Tensors: 194
[MEM] After backward, before release - Used: 4281MB, Free: 7628MB, Tensors: 124
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After backward, before release - Used: 4620MB, Free: 7280MB, Tensors: 124
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After all releases - Used: 3321MB, Free: 8588MB, Tensors: 112
Micro 2 Active Tensors: 112

 microstep = 3
[MEM] Start of micro_step 3 - Used: 3321MB, Free: 8588MB, Tensors: 112


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 


[MEM] After all releases - Used: 3660MB, Free: 8240MB, Tensors: 112
Micro 2 Active Tensors: 112

 microstep = 3
[MEM] Start of micro_step 3 - Used: 3660MB, Free: 8240MB, Tensors: 112


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 3321MB, Free: 8588MB, Tensors: 120


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 3321MB, Free: 8588MB, Tensors: 122
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 3660MB, Free: 8240MB, Tensors: 120


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 3660MB, Free: 8240MB, Tensors: 122
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 3321MB, Free: 8588MB, Tensors: 123


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output
[MEM] After tok+pos add - Used: 3660MB, Free: 8240MB, Tensors: 123


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 3609MB, Free: 8300MB, Tensors: 134
[MEM] After MLP block 0 - Used: 3916MB, Free: 7984MB, Tensors: 134


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 3929MB, Free: 7980MB, Tensors: 145
[MEM] After MLP block 1 - Used: 4236MB, Free: 7664MB, Tensors: 145


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 4249MB, Free: 7660MB, Tensors: 156
[MEM] After MLP block 2 - Used: 4556MB, Free: 7344MB, Tensors: 156


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 4569MB, Free: 7340MB, Tensors: 167
[MEM] After MLP block 3 - Used: 4844MB, Free: 7056MB, Tensors: 167


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 4889MB, Free: 7020MB, Tensors: 178
[MEM] After MLP block 4 - Used: 5196MB, Free: 6704MB, Tensors: 178


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 5241MB, Free: 6668MB, Tensors: 189
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5241MB, Free: 6668MB, Tensors: 189
[MEM] After MLP block 5 - Used: 5548MB, Free: 6352MB, Tensors: 189
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 5548MB, Free: 6352MB, Tensors: 189
[MEM] After ln_f - Used: 5273MB, Free: 6636MB, Tensors: 194
[MEM] Before lm_head - Used: 5273MB, Free: 6636MB, Tensors: 194
[MEM] After ln_f - Used: 5580MB, Free: 6320MB, Tensors: 194
[MEM] Before lm_head - Used: 5580MB, Free: 6320MB, Tensors: 194


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 6073MB, Free: 5836MB, Tensors: 196
[MEM] After lm_head - Used: 6348MB, Free: 5552MB, Tensors: 196
[MEM] After backward, before release - Used: 4281MB, Free: 7628MB, Tensors: 126
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After backward, before release - Used: 4620MB, Free: 7280MB, Tensors: 126
=== REFCOUNTS BEFORE RELEASE ===
[REFCOUNT] loss: impl=1, storage=1
[REFCOUNT] grad_scale: impl=1, storage=1
[REFCOUNT] batch.input (x): impl=1, storage=1
[REFCOUNT] batch.target (y): impl=1, storage=1
[REFCOUNT] model.logits: impl=1, storage=1
[REFCOUNT] model.y: impl=1, storage=1
[MEM] After all releases - Used: 3321MB, Free: 8588MB, Tensors: 114
Micro 3 Active Tensors: 114
[MEM] After all releases - Used: 3660MB, Free: 8240MB, Tensors: 114
Micro 3 Active Tensors: 114
step     0 | loss: 10.825840 | lr 3.6991e-08 | norm: 0.0000 | dt: 14736.32ms | tok/sec: 2223.62

=== START OF STEP 1 ===

=== ACTIVE TENSOR REGISTRY (205 tensors) ===
Tensor 0x5ea29cb423c0 | Refcount: 1 | Device: 0 | Shape: [25152,768] | GradFn: None/Null | 
Tensor 0x5ea2a0f68780 | Refcount: 1 | Device: 0 | Shape: [1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a16b59e0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b5dc0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b5e60 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b6430 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a16b77a0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a16bc110 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a16be370 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1711d50 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a1714020 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a17151b0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1715820 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a1715df0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1716bb0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1717610 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a171e960 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1720c50 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a17210b0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1722db0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a17239e0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1723c20 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a17245a0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a1727060 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1728c20 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a172b250 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a172b3b0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a172e490 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a172e760 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a17304f0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1732b90 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1734e80 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a17352e0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1737030 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a1737c60 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1738c00 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a173b0f0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a173cc70 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a173ef60 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a173f3c0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a17410c0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a1741690 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x5ea2a1742650 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x5ea2a17427b0 | Refcount: 2 | Device: 0 | Shape: [768] | GradFn: None/Null | 
Tensor 0x5ea2a1745da0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x5ea2a17481e0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x5ea2a17484f0 | Refcount: 1 | Device: 0 | Shape: [8,1024] | Autograd: None | 
Tensor 0x5ea2a174ada0 | Refcount: 1 | Device: 0 | Shape: [1,1024] | Autograd: None | 
Tensor 0x5ea2a174be30 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a17536f0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a1755330 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a1756160 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a1756850 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a1757520 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a17576a0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a1758920 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a1759ee0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a42a80b0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a42a8640 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a42a8b40 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a42d6690 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a46c19a0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a46c1f60 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a46c1fe0 | Refcount: 1 | Device: 0 | Shape: [1024,768] | Autograd: None | 
Tensor 0x5ea2a46c28a0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a46c2ee0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a88f3cb0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a88f7870 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a898b880 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89926f0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a8993940 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a8993d90 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a8994960 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a8995670 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a8995920 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a8996680 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89972c0 | Refcount: 1 | Device: 0 | Shape: [1024,768] | Autograd: None | 
Tensor 0x5ea2a8998350 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a8999040 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a899ab80 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a899b790 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a899c990 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a899ca10 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a899ca90 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a899d380 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a899e4a0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a899fbd0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a899fca0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89a0390 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89a0ef0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89a1810 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89a1f40 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89a49e0 | Refcount: 1 | Device: 0 | Shape: [25152,768] | Autograd: None | 
Tensor 0x5ea2a89a5b70 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89a8a00 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89ab050 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a89ac9a0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a89b0d80 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89b3180 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89b3860 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89b5640 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | Autograd: None | 
Tensor 0x5ea2a89b5de0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a89b78b0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89b8970 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89bbea0 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89c1190 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89c1b40 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89c1e30 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89c2280 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89c2aa0 | Refcount: 6 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89c5880 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89c6130 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89c72f0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89c7f90 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89c83e0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89c88e0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89c8de0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a89caab0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89cb2a0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a89cb680 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a89cbb80 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89ce860 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a89cf330 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89cf4e0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a89cf760 | Refcount: 1 | Device: 0 | Shape: [25152,768] | Autograd: None | 
Tensor 0x5ea2a89d0610 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89d1c60 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a89d2780 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2a89d46f0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89d4d60 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89d58d0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89d5f40 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a89f6160 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a89f6ef0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a9f91cc0 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a9f92a40 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a9f93da0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a9f94770 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a9f94bc0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a9f94ef0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a9fa0610 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a9fa0d30 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2a9fa0db0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a9fa3290 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2a9fa3340 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a9fa4470 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2a9fa4ab0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2a9fa50a0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a9fa7240 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2a9fa7530 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa3595c0 | Refcount: 1 | Device: 0 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x5ea2aa359b70 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa35cf80 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa35d9c0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa35e310 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa360250 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa360a60 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2aa3613a0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa362190 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa3646e0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa365590 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa366180 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2aa367750 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa9234c0 | Refcount: 1 | Device: 0 | Shape: [1024,768] | Autograd: None | 
Tensor 0x5ea2aa923900 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa924520 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa9257e0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa927800 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa928260 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa928c40 | Refcount: 1 | Device: 0 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x5ea2aa932ce0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa933790 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa933db0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa934070 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa935450 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa937240 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa937b10 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa937b90 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa939f90 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa93a060 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa93a130 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa93ac20 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa93af40 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa93b700 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa93eb10 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa942450 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa9428a0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa942cf0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa943140 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa947120 | Refcount: 1 | Device: 0 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x5ea2aa94b2f0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa94b3c0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa94b6e0 | Refcount: 1 | Device: 0 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x5ea2aa953050 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa953880 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa953cf0 | Refcount: 1 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa9545e0 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa954a00 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa954e50 | Refcount: 1 | Device: 0 | Shape: [768] | Autograd: None | 
Tensor 0x5ea2aa956f50 | Refcount: 2 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x5ea2aa957bf0 | Refcount: 2 | Device: 0 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
... (truncated remaining 5)
==========================================


=== START OF STEP 1 ===

=== ACTIVE TENSOR REGISTRY (205 tensors) ===
Tensor 0x641e47b98170 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4bfabca0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4bfbe520 | Refcount: 1 | Device: 1 | Shape: [1024,768] | GradFn: None/Null | 
Tensor 0x641e4c70ad80 | Refcount: 1 | Device: 1 | Shape: [25152,768] | GradFn: None/Null | 
Tensor 0x641e4c70d700 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c70d780 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c70f7f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e4c70ff50 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c7109c0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c7116d0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c712b20 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c715200 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c729ea0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c72bc00 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c72cec0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e4c72dcf0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c731d30 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c733140 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c734d00 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c737340 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c739c90 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c73a300 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c73a380 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e4c73d430 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c73eff0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c741630 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c741790 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c743440 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c743ba0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c745f00 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c747ac0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c74a260 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c74be90 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c74d000 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c74e5e0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c74ee90 | Refcount: 1 | Device: 1 | Shape: [8,1024] | Autograd: None | 
Tensor 0x641e4c750400 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c752a80 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c756e50 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c757fc0 | Refcount: 2 | Device: 1 | Shape: [768] | GradFn: None/Null | 
Tensor 0x641e4c759e90 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | GradFn: None/Null | 
Tensor 0x641e4c75b9f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | GradFn: None/Null | 
Tensor 0x641e4c75de40 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | GradFn: None/Null | 
Tensor 0x641e4c75e150 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c7608d0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | GradFn: None/Null | 
Tensor 0x641e4c761030 | Refcount: 1 | Device: 1 | Shape: [1,1024] | Autograd: None | 
Tensor 0x641e4c7678f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c767c10 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e4c76b970 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c76bdc0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e4c76c210 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e4c76d820 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4c76dfb0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4c76e030 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4c76e950 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e4ef087c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e4f2be090 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e4f2eb830 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e4f2ebd10 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4f2ecb70 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4f2f2830 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e4f6d79c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e4f6d89f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4f6d95f0 | Refcount: 1 | Device: 1 | Shape: [25152,768] | Autograd: None | 
Tensor 0x641e4f6da310 | Refcount: 1 | Device: 1 | Shape: [1024,768] | Autograd: None | 
Tensor 0x641e4f6da9b0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e4f6db0a0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e4f6db170 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e5390ac70 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e5390b940 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5390c290 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e5390c4a0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5390c520 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e5390c620 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5390f1a0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e539a4750 | Refcount: 1 | Device: 1 | Shape: [1024,768] | Autograd: None | 
Tensor 0x641e539a4bf0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539a5130 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539a6230 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e539a82b0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e539a83f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539a8470 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539a92e0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539a9390 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539a9550 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539ac060 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539ac870 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539acc10 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e539af2c0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539afa70 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539b1570 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539b2320 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539b27f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e539b28f0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539b37f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539b42e0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539b6890 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539b6e90 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539b80f0 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e539b8630 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539b9930 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539bade0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539bbf70 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539bc3c0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539bd690 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e539beb70 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539c0bb0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539c25c0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539c65a0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539c84a0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539c93c0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539ca990 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e539cb490 | Refcount: 1 | Device: 1 | Shape: [1024,768] | Autograd: None | 
Tensor 0x641e539ce3c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539ceba0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539cec70 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e539cf1c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539cfba0 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e539cff70 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539d04c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539d09e0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539d0b10 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539d0c00 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539d2320 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e539d3260 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539d4f10 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539d5540 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539d5b10 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539d6620 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539d81c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e539d93b0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539dbf40 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539dd730 | Refcount: 1 | Device: 1 | Shape: [25152,768] | Autograd: None | 
Tensor 0x641e539df890 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539e00e0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539e0530 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539e2810 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e539e49d0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e539e4aa0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539e7680 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e539e8260 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e539eb710 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e539ed280 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e539ed870 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e53a086e0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e53a0db00 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e53a0de30 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e54fa9d50 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e54faab40 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e54fab4c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e54fabb50 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e54fadc00 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e54fae870 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e54fb6650 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e54fb7680 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e54fb86f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e54fbc6f0 | Refcount: 6 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e54fbcfd0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e54fbecc0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e54fbf320 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e54fbfc10 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e54fc03a0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55370f60 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e553719c0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e55374830 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55377350 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e553776a0 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e55378190 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e55379530 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e5537d7f0 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5537eb30 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55904bc0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e5593b450 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e5593b520 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | Autograd: None | 
Tensor 0x641e5593b990 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e5593d4f0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e5593d7e0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55948630 | Refcount: 1 | Device: 1 | Shape: [8,3072,768] | Autograd: None | 
Tensor 0x641e5594b660 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e5594c490 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e5594c6d0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e5594ca60 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e5594f690 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5594fcf0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55955710 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e55955b60 | Refcount: 1 | Device: 1 | Shape: [8,1024,3072] | Autograd: None | 
Tensor 0x641e559569b0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55959b80 | Refcount: 2 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5595a820 | Refcount: 2 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e5596b420 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e55d7b7d0 | Refcount: 1 | Device: 1 | Shape: [8,1024,768] | Autograd: None | 
Tensor 0x641e55d7c6c0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7cb10 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7d340 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7d790 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7dbe0 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7e030 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7e480 | Refcount: 1 | Device: 1 | Shape: [768] | Autograd: None | 
Tensor 0x641e55d7ffd0 | Refcount: 1 | Device: 1 | Shape: [8,768,3072] | Autograd: None | 
Tensor 0x641e55d80330 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
Tensor 0x641e55d8c990 | Refcount: 1 | Device: 1 | Shape: [8,1024,1] | GradFn: AllReduceSumBackward | 
... (truncated remaining 5)
==========================================


 microstep = 0
[MEM] Start of micro_step 0 - Used: 6553MB, Free: 5356MB, Tensors: 206


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 



 microstep = 0
[MEM] Start of micro_step 0 - Used: 6796MB, Free: 5104MB, Tensors: 206


 idx shape = [ 8 , 1024 ] 




 Didx shape = [ 8 , 1024 ] 




 Didx size = [ 8192 




 Dpos shape = [ 1 , 1024 ] 




 Dpos size = [ 1024 ] 




 pos_idx shape = [ 1024 ] 


 

 Set Data for pos_emb not done 


  [FWD] pod_emb done
 

 Set Data for idx_emb not done 




 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 6553MB, Free: 5356MB, Tensors: 214


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  0 name = DEmbedding_output
[MEM] After pos_emb - Used: 6553MB, Free: 5356MB, Tensors: 216
  tok_emb device: 0 shape: [8,1024,768]
  pos_emb device: 0 shape: [1,1024,768]


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DEmbeddingVParallel_output
[MEM] After tok_emb - Used: 6828MB, Free: 5072MB, Tensors: 214


 shape = [ 1 , 1024 ] 


 size = 786432 rank =  1 name = DEmbedding_output
[MEM] After pos_emb - Used: 6828MB, Free: 5072MB, Tensors: 216
  tok_emb device: 1 shape: [8,1024,768]
  pos_emb device: 1 shape: [1,1024,768]
[MEM] After tok+pos add - Used: 6585MB, Free: 5324MB, Tensors: 217
[MEM] After tok+pos add - Used: 6860MB, Free: 5040MB, Tensors: 217


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 0 - Used: 6937MB, Free: 4972MB, Tensors: 228
[MEM] After MLP block 0 - Used: 7244MB, Free: 4656MB, Tensors: 228


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 1 - Used: 7321MB, Free: 4588MB, Tensors: 239
[MEM] After MLP block 1 - Used: 7628MB, Free: 4272MB, Tensors: 239


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 2 - Used: 7705MB, Free: 4204MB, Tensors: 250
[MEM] After MLP block 2 - Used: 7980MB, Free: 3920MB, Tensors: 250


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 3 - Used: 8089MB, Free: 3820MB, Tensors: 261
[MEM] After MLP block 3 - Used: 8364MB, Free: 3536MB, Tensors: 261


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 4 - Used: 8473MB, Free: 3436MB, Tensors: 272
[MEM] After MLP block 4 - Used: 8748MB, Free: 3152MB, Tensors: 272


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = DColumnLinear_output


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  0 name = 


 shape = [ 8 , 1024 ] 


 size = 12582912 rank =  1 name = 


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  0 name = DRowLinear_output


 shape = [ 8 , 1024 ] 


 size = 6291456 rank =  1 name = DRowLinear_output
[MEM] After MLP block 5 - Used: 8857MB, Free: 3052MB, Tensors: 283
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 8857MB, Free: 3052MB, Tensors: 283
[MEM] After MLP block 5 - Used: 9132MB, Free: 2768MB, Tensors: 283
  [FWD] All MLP blocks done
[MEM] Before ln_f - Used: 9132MB, Free: 2768MB, Tensors: 283
[MEM] After ln_f - Used: 8889MB, Free: 3020MB, Tensors: 288
[MEM] Before lm_head - Used: 8889MB, Free: 3020MB, Tensors: 288
[MEM] After ln_f - Used: 9164MB, Free: 2736MB, Tensors: 288
[MEM] Before lm_head - Used: 9164MB, Free: 2736MB, Tensors: 288


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  0 name = lm_head_sharded_output


 shape = [ 8 , 1024 ] 


 size = 412090368 rank =  1 name = lm_head_sharded_output
[MEM] After lm_head - Used: 9689MB, Free: 2220MB, Tensors: 290
[MEM] After lm_head - Used: 9964MB, Free: 1936MB, Tensors: 290
CUDA Allocation Failed: out of memory(requested 786 MB
CUDA Allocation Failed: out of memory(requested 786 MB
ERROR: CUDA allcation failed
ERROR: CUDA allcation failed
--------------------------------------------------------------------------
prterun detected that one or more processes exited with non-zero status,
thus causing the job to be terminated. The first process to do so was:

   Process name: [prterun-blubridge25-MS-7E06-65077@1,0]
   Exit code:    1
--------------------------------------------------------------------------
