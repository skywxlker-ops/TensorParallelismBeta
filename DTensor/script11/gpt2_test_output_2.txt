--- Compiling snippet: ../gpt2_test.cpp ---
g++ -Iinclude -I/usr/local/cuda/include -DWITH_CUDA  -std=c++20 -fPIC -Wall -Wextra -g -O3 -fopenmp -o snippet_runner ../gpt2_test.cpp -L/usr/local/cuda/lib64 -Llib -Xlinker -rpath -Xlinker '$ORIGIN/lib' -ltensor -lcudart -ltbb -lcurand -lcublas
In file included from include/dtype/DtypeTraits.h:15,
                 from include/TensorLib.h:16,
                 from ../gpt2_test.cpp:19:
include/dtype/fp4.h: In function ‘uint8_t detail_fp4::float_to_fp4_e2m1(float)’:
include/dtype/fp4.h:44:11: warning: dereferencing type-punned pointer will break strict-aliasing rules [-Wstrict-aliasing]
   44 |     if ((*(uint32_t*)&f) & 0x80000000) sign_bit = 8;
      |           ^~~~~~~~~~~~~
../gpt2_test.cpp: In constructor ‘MLP::MLP(int64_t, OwnTensor::DeviceIndex, uint64_t)’:
../gpt2_test.cpp:144:17: warning: ‘MLP::n_embd_’ will be initialized after [-Wreorder]
  144 |         int64_t n_embd_;
      |                 ^~~~~~~
../gpt2_test.cpp:85:23: warning:   ‘OwnTensor::nn::LayerNorm MLP::ln’ [-Wreorder]
   85 |         nn::LayerNorm ln;       // LayerNorm before MLP
      |                       ^~
../gpt2_test.cpp:89:9: warning:   when initialized here [-Wreorder]
   89 |         MLP(int64_t n_embd, DeviceIndex device, uint64_t seed = 1234)
      |         ^~~
../gpt2_test.cpp: In member function ‘std::vector<OwnTensor::Tensor*> MLP::parameters()’:
../gpt2_test.cpp:129:24: warning: unused variable ‘p’ [-Wunused-variable]
  129 |             for (auto& p : ln.parameters()) {
      |                        ^
../gpt2_test.cpp: In member function ‘OwnTensor::Tensor GPT::forward(const OwnTensor::Tensor&, bool)’:
../gpt2_test.cpp:177:21: warning: unused variable ‘B’ [-Wunused-variable]
  177 |             int64_t B = shape[0];
      |                     ^
../gpt2_test.cpp: In function ‘int main()’:
../gpt2_test.cpp:458:39: warning: unused variable ‘x_data’ [-Wunused-variable]
  458 |                             uint16_t* x_data = x_cpu.data<uint16_t>(); // Input x is NOT uint16! Wait.
      |                                       ^~~~~~
../gpt2_test.cpp:547:24: warning: unused variable ‘t_data’ [-Wunused-variable]
  547 |                 double t_data = 0, t_forward = 0, t_backward = 0;
      |                        ^~~~~~
../gpt2_test.cpp:547:36: warning: unused variable ‘t_forward’ [-Wunused-variable]
  547 |                 double t_data = 0, t_forward = 0, t_backward = 0;
      |                                    ^~~~~~~~~
../gpt2_test.cpp:547:51: warning: unused variable ‘t_backward’ [-Wunused-variable]
  547 |                 double t_data = 0, t_forward = 0, t_backward = 0;
      |                                                   ^~~~~~~~~~
../gpt2_test.cpp:582:24: warning: unused variable ‘t_clip’ [-Wunused-variable]
  582 |                 double t_clip = std::chrono::duration<double, std::milli>(t_c1 - t_c0).count();
      |                        ^~~~~~
../gpt2_test.cpp:593:24: warning: unused variable ‘t_opt’ [-Wunused-variable]
  593 |                 double t_opt = std::chrono::duration<double, std::milli>(t_o1 - t_o0).count();
      |                        ^~~~~
In file included from ../gpt2_test.cpp:31:
../dl_test.cpp: At global scope:
../dl_test.cpp:25:12: warning: ‘int getenv_int(const char*, int)’ defined but not used [-Wunused-function]
   25 | static int getenv_int(const char* key, int def) {
      |            ^~~~~~~~~~

--- Running snippet_runner ---
./snippet_runner
=== GPT-2 Training Script (C++ Implementation) ===
Configuration:
  vocab_size: 50304
  context_length: 1024
  n_embd: 768
  n_layers: 6
  B=2, T=128
  global_batch: 1024
  grad_accum_steps: 4

Initializing model on CUDA device 0...
Number of parameters: 67765248
found 10 shards for split train
Tokens: 100000000
found 1 shards for split val
Tokens: 100000000

Starting training...
Tokens: 100000000
Val step 0 Max target: 48866
Val step 0 Loss: 10.9417
Val step 1 Max target: 47866
Val step 1 Loss: 10.9124
Val step 2 Max target: 48599
Val step 2 Loss: 10.8795
Val step 3 Max target: 50256
Val step 3 Loss: 10.9325
Val step 4 Max target: 48384
Val step 4 Loss: 10.8673
Val step 5 Max target: 47128
Val step 5 Loss: 10.875
Val step 6 Max target: 48461
Val step 6 Loss: 10.898
Val step 7 Max target: 50256
Val step 7 Loss: 10.8224
Val step 8 Max target: 45486
Val step 8 Loss: 10.9589
Val step 9 Max target: 45500
Val step 9 Loss: 10.923
Val step 10 Max target: 49158
Val step 10 Loss: 10.9148
Val step 11 Max target: 31504
Val step 11 Loss: 10.9187
Val step 12 Max target: 46181
Val step 12 Loss: nan
DEBUG: Loss is NaN at step 12! Re-running forward with layer checks...
x after add (sample: -0.0134233)
x after ln_f (sample: -1.34253)
wte_t (sample: 0.0156195)
CRITICAL: NaN/Inf in x BEFORE final projection at index 768
wte_t is clean before matmul
logits (sample: -0.75965)
DEBUG: Checking Logits...
Logits NaN/Inf: YES
Logits Range: [-2.88538, 2.9171]
Running Reference CPU LayerNorm...
Val step 13 Max target: 48137
Val step 13 Loss: 10.9533
Val step 14 Max target: 33290
Val step 14 Loss: 10.9125
Val step 15 Max target: 44529
Val step 15 Loss: 10.8833
Val step 16 Max target: 33290
Val step 16 Loss: 10.8863
Val step 17 Max target: 44529
Val step 17 Loss: 10.9009
Val step 18 Max target: 44529
Val step 18 Loss: 10.9093
Val step 19 Max target: 33290
Val step 19 Loss: 10.8891
validation loss: nan
step     0 | loss: 10.918669 | lr 1.2330e-07 | norm: 3.0560 | dt: 2799.91ms | tok/sec: 365.73
step     1 | loss: 10.853679 | lr 2.4661e-07 | norm: 3.2478 | dt: 1075.30ms | tok/sec: 952.29
step     2 | loss: 10.894970 | lr 3.6991e-07 | norm: 3.0453 | dt: 1040.67ms | tok/sec: 983.98
step     3 | loss: 10.895162 | lr 4.9322e-07 | norm: 2.9280 | dt: 1090.34ms | tok/sec: 939.15
step     4 | loss: 10.924699 | lr 6.1652e-07 | norm: 2.8418 | dt: 1029.84ms | tok/sec: 994.33
step     5 | loss: 10.875474 | lr 7.3983e-07 | norm: 3.0143 | dt: 1057.93ms | tok/sec: 967.93
step     6 | loss: 10.900767 | lr 8.6313e-07 | norm: 2.7135 | dt: 1051.45ms | tok/sec: 973.90
step     7 | loss: 10.882757 | lr 9.8644e-07 | norm: 2.7751 | dt: 1043.10ms | tok/sec: 981.68
step     8 | loss: 10.873400 | lr 1.1097e-06 | norm: 3.1107 | dt: 1017.20ms | tok/sec: 1006.69
step     9 | loss: 10.901957 | lr 1.2330e-06 | norm: 3.0978 | dt: 1038.61ms | tok/sec: 985.93
step    10 | loss: 10.882579 | lr 1.3564e-06 | norm: 2.9090 | dt: 1043.58ms | tok/sec: 981.23
step    11 | loss: 10.846298 | lr 1.4797e-06 | norm: 2.8568 | dt: 1031.99ms | tok/sec: 992.26
step    12 | loss: 10.869847 | lr 1.6030e-06 | norm: 3.0050 | dt: 1052.82ms | tok/sec: 972.63
step    13 | loss: 10.874647 | lr 1.7263e-06 | norm: 3.1487 | dt: 1060.36ms | tok/sec: 965.71
step    14 | loss: 10.863246 | lr 1.8496e-06 | norm: 2.8066 | dt: 1082.45ms | tok/sec: 946.00
step    15 | loss: 10.819111 | lr 1.9729e-06 | norm: 3.2872 | dt: 1019.12ms | tok/sec: 1004.79
step    16 | loss: 10.843840 | lr 2.0962e-06 | norm: 3.1206 | dt: 1030.75ms | tok/sec: 993.45
step    17 | loss: 10.841420 | lr 2.2195e-06 | norm: 2.6835 | dt: 1078.68ms | tok/sec: 949.31
step    18 | loss: 10.823915 | lr 2.3428e-06 | norm: 2.7362 | dt: 1039.62ms | tok/sec: 984.98
step    19 | loss: 10.766871 | lr 2.4661e-06 | norm: 3.2349 | dt: 1038.52ms | tok/sec: 986.02
step    20 | loss: 10.770930 | lr 2.5894e-06 | norm: 3.0336 | dt: 1045.60ms | tok/sec: 979.34
step    21 | loss: 10.770863 | lr 2.7127e-06 | norm: 3.1979 | dt: 1052.66ms | tok/sec: 972.78
step    22 | loss: 10.745222 | lr 2.8360e-06 | norm: 3.4383 | dt: 1044.22ms | tok/sec: 980.64
step    23 | loss: 10.741156 | lr 2.9593e-06 | norm: 3.2719 | dt: 1043.45ms | tok/sec: 981.36
step    24 | loss: 10.803490 | lr 3.0826e-06 | norm: 2.7535 | dt: 1063.47ms | tok/sec: 962.89
step    25 | loss: 10.809736 | lr 3.2059e-06 | norm: 3.4093 | dt: 1063.20ms | tok/sec: 963.13
step    26 | loss: 10.769833 | lr 3.3292e-06 | norm: 3.2147 | dt: 1009.45ms | tok/sec: 1014.42
step    27 | loss: 10.753513 | lr 3.4525e-06 | norm: 3.1529 | dt: 1060.23ms | tok/sec: 965.83
step    28 | loss: 10.702446 | lr 3.5758e-06 | norm: 2.8784 | dt: 1056.39ms | tok/sec: 969.34
step    29 | loss: 10.688814 | lr 3.6991e-06 | norm: 2.9846 | dt: 1045.25ms | tok/sec: 979.67
step    30 | loss: 10.667928 | lr 3.8224e-06 | norm: 3.0782 | dt: 1048.56ms | tok/sec: 976.58
step    31 | loss: 10.737040 | lr 3.9457e-06 | norm: 2.8142 | dt: 1052.63ms | tok/sec: 972.80
step    32 | loss: 10.627713 | lr 4.0691e-06 | norm: 3.6358 | dt: 1079.52ms | tok/sec: 948.57
step    33 | loss: 10.637468 | lr 4.1924e-06 | norm: 3.5302 | dt: 1061.10ms | tok/sec: 965.04
step    34 | loss: 10.724699 | lr 4.3157e-06 | norm: 3.2802 | dt: 1082.75ms | tok/sec: 945.74
step    35 | loss: 10.611214 | lr 4.4390e-06 | norm: 3.1626 | dt: 1032.36ms | tok/sec: 991.90
step    36 | loss: 10.660584 | lr 4.5623e-06 | norm: 2.9730 | dt: 1049.87ms | tok/sec: 975.36
step    37 | loss: 10.669725 | lr 4.6856e-06 | norm: 2.8423 | dt: 1036.76ms | tok/sec: 987.69
step    38 | loss: 10.689964 | lr 4.8089e-06 | norm: 2.9194 | dt: 1031.22ms | tok/sec: 993.00
step    39 | loss: 10.571248 | lr 4.9322e-06 | norm: 3.0299 | dt: 1048.57ms | tok/sec: 976.57
step    40 | loss: 10.589968 | lr 5.0555e-06 | norm: 2.9399 | dt: 1044.27ms | tok/sec: 980.59
step    41 | loss: 10.580994 | lr 5.1788e-06 | norm: 2.9542 | dt: 1020.02ms | tok/sec: 1003.90
step    42 | loss: 10.588179 | lr 5.3021e-06 | norm: 2.7548 | dt: 1042.90ms | tok/sec: 981.87
step    43 | loss: 10.541989 | lr 5.4254e-06 | norm: 2.8928 | dt: 1081.72ms | tok/sec: 946.64
step    44 | loss: 10.556543 | lr 5.5487e-06 | norm: 2.9878 | dt: 1041.24ms | tok/sec: 983.44
step    45 | loss: 10.512392 | lr 5.6720e-06 | norm: 2.9594 | dt: 1069.45ms | tok/sec: 957.51
step    46 | loss: 10.529747 | lr 5.7953e-06 | norm: 2.9426 | dt: 1052.36ms | tok/sec: 973.05
step    47 | loss: 10.478099 | lr 5.9186e-06 | norm: 3.0580 | dt: 1042.68ms | tok/sec: 982.09
step    48 | loss: 10.432860 | lr 6.0419e-06 | norm: 2.9594 | dt: 1077.29ms | tok/sec: 950.53
step    49 | loss: 10.445261 | lr 6.1652e-06 | norm: 2.8666 | dt: 1047.19ms | tok/sec: 977.86
step    50 | loss: 10.424617 | lr 6.2885e-06 | norm: 3.0650 | dt: 1066.45ms | tok/sec: 960.20
step    51 | loss: 10.383528 | lr 6.4118e-06 | norm: 2.9239 | dt: 1003.09ms | tok/sec: 1020.85
step    52 | loss: 10.440472 | lr 6.5351e-06 | norm: 2.7727 | dt: 1061.62ms | tok/sec: 964.56
step    53 | loss: 10.476265 | lr 6.6584e-06 | norm: 2.5538 | dt: 1021.41ms | tok/sec: 1002.53
step    54 | loss: 10.387440 | lr 6.7818e-06 | norm: 2.7329 | dt: 1049.62ms | tok/sec: 975.59
step    55 | loss: 10.407794 | lr 6.9051e-06 | norm: 2.7550 | dt: 1040.24ms | tok/sec: 984.38
step    56 | loss: 10.328716 | lr 7.0284e-06 | norm: 2.9685 | dt: 1078.04ms | tok/sec: 949.87
step    57 | loss: 10.330740 | lr 7.1517e-06 | norm: 2.8626 | dt: 1063.20ms | tok/sec: 963.13
step    58 | loss: 10.328327 | lr 7.2750e-06 | norm: 2.7669 | dt: 1043.70ms | tok/sec: 981.13
step    59 | loss: 10.365459 | lr 7.3983e-06 | norm: 2.6901 | dt: 1031.12ms | tok/sec: 993.10
step    60 | loss: 10.263716 | lr 7.5216e-06 | norm: 2.9342 | dt: 1047.51ms | tok/sec: 977.56
step    61 | loss: 10.270410 | lr 7.6449e-06 | norm: 2.8683 | dt: 1041.95ms | tok/sec: 982.77
step    62 | loss: 10.364031 | lr 7.7682e-06 | norm: 3.0873 | dt: 1079.68ms | tok/sec: 948.43
step    63 | loss: 10.241236 | lr 7.8915e-06 | norm: 2.8255 | dt: 1020.39ms | tok/sec: 1003.54
step    64 | loss: 10.275926 | lr 8.0148e-06 | norm: 2.7496 | dt: 1088.89ms | tok/sec: 940.41
step    65 | loss: 10.278618 | lr 8.1381e-06 | norm: 2.7533 | dt: 1039.25ms | tok/sec: 985.33
step    66 | loss: 10.195262 | lr 8.2614e-06 | norm: 2.8879 | dt: 1042.74ms | tok/sec: 982.03
step    67 | loss: 10.272971 | lr 8.3847e-06 | norm: 2.6252 | dt: 1044.63ms | tok/sec: 980.25
step    68 | loss: 10.202177 | lr 8.5080e-06 | norm: 2.9349 | dt: 1022.24ms | tok/sec: 1001.72
step    69 | loss: 10.095229 | lr 8.6313e-06 | norm: 2.7652 | dt: 1062.81ms | tok/sec: 963.49
step    70 | loss: 10.205173 | lr 8.7546e-06 | norm: 2.6184 | dt: 1046.73ms | tok/sec: 978.28
step    71 | loss: 10.161792 | lr 8.8779e-06 | norm: 2.9504 | dt: 1021.11ms | tok/sec: 1002.83
step    72 | loss: 10.152899 | lr 9.0012e-06 | norm: 2.6601 | dt: 1079.11ms | tok/sec: 948.93
step    73 | loss: 10.257506 | lr 9.1245e-06 | norm: 2.6400 | dt: 1058.40ms | tok/sec: 967.50
step    74 | loss: 10.137800 | lr 9.2478e-06 | norm: 2.5875 | dt: 1045.43ms | tok/sec: 979.50
step    75 | loss: 10.188503 | lr 9.3711e-06 | norm: 2.5578 | dt: 1046.73ms | tok/sec: 978.29
step    76 | loss: 10.158678 | lr 9.4945e-06 | norm: 2.8059 | dt: 1066.36ms | tok/sec: 960.27
step    77 | loss: 10.140752 | lr 9.6178e-06 | norm: 2.7105 | dt: 1091.55ms | tok/sec: 938.12
step    78 | loss: 10.010145 | lr 9.7411e-06 | norm: 3.1228 | dt: 1065.23ms | tok/sec: 961.30
step    79 | loss: 9.907524 | lr 9.8644e-06 | norm: 3.2371 | dt: 1086.85ms | tok/sec: 942.17
step    80 | loss: 9.957315 | lr 9.9877e-06 | norm: 2.8612 | dt: 1053.95ms | tok/sec: 971.58
step    81 | loss: 9.870648 | lr 1.0111e-05 | norm: 3.2104 | dt: 1045.73ms | tok/sec: 979.22
step    82 | loss: 10.020697 | lr 1.0234e-05 | norm: 2.6080 | dt: 1084.89ms | tok/sec: 943.87
step    83 | loss: 10.060619 | lr 1.0358e-05 | norm: 2.6279 | dt: 1076.28ms | tok/sec: 951.43
step    84 | loss: 9.885241 | lr 1.0481e-05 | norm: 2.8633 | dt: 1046.76ms | tok/sec: 978.26
step    85 | loss: 9.980811 | lr 1.0604e-05 | norm: 2.7270 | dt: 1038.32ms | tok/sec: 986.20
step    86 | loss: 9.894621 | lr 1.0727e-05 | norm: 2.7029 | dt: 1053.57ms | tok/sec: 971.93
step    87 | loss: 9.930080 | lr 1.0851e-05 | norm: 2.7001 | dt: 1047.14ms | tok/sec: 977.90
step    88 | loss: 9.896717 | lr 1.0974e-05 | norm: 2.6969 | dt: 1074.25ms | tok/sec: 953.22
step    89 | loss: 9.826927 | lr 1.1097e-05 | norm: 2.9297 | dt: 1066.40ms | tok/sec: 960.24
step    90 | loss: 9.964224 | lr 1.1221e-05 | norm: 2.6924 | dt: 1027.16ms | tok/sec: 996.93
step    91 | loss: 9.811414 | lr 1.1344e-05 | norm: 2.9808 | dt: 1077.59ms | tok/sec: 950.27
step    92 | loss: 10.084849 | lr 1.1467e-05 | norm: 2.5812 | dt: 1047.42ms | tok/sec: 977.64
step    93 | loss: 10.083464 | lr 1.1591e-05 | norm: 2.3709 | dt: 1046.22ms | tok/sec: 978.76
step    94 | loss: 9.900723 | lr 1.1714e-05 | norm: 2.7396 | dt: 1042.37ms | tok/sec: 982.38
step    95 | loss: 9.789591 | lr 1.1837e-05 | norm: 2.7838 | dt: 1044.66ms | tok/sec: 980.22
step    96 | loss: 9.962595 | lr 1.1961e-05 | norm: 2.4645 | dt: 1040.92ms | tok/sec: 983.74
step    97 | loss: 9.799452 | lr 1.2084e-05 | norm: 2.8043 | dt: 1022.38ms | tok/sec: 1001.59
step    98 | loss: 9.756204 | lr 1.2207e-05 | norm: 2.7195 | dt: 1050.36ms | tok/sec: 974.90
step    99 | loss: 9.946235 | lr 1.2330e-05 | norm: 2.4406 | dt: 1032.10ms | tok/sec: 992.15
step   100 | loss: 9.765835 | lr 1.2454e-05 | norm: 2.9521 | dt: 1020.60ms | tok/sec: 1003.34
step   101 | loss: 9.821996 | lr 1.2577e-05 | norm: 2.7568 | dt: 1039.44ms | tok/sec: 985.14
step   102 | loss: 9.589483 | lr 1.2700e-05 | norm: 3.0265 | dt: 1062.67ms | tok/sec: 963.61
step   103 | loss: 9.642844 | lr 1.2824e-05 | norm: 2.9697 | dt: 1094.08ms | tok/sec: 935.95
step   104 | loss: 9.905334 | lr 1.2947e-05 | norm: 2.4361 | dt: 1040.39ms | tok/sec: 984.24
step   105 | loss: 9.958767 | lr 1.3070e-05 | norm: 2.5761 | dt: 1060.68ms | tok/sec: 965.41
step   106 | loss: 9.935234 | lr 1.3194e-05 | norm: 2.7418 | dt: 1035.51ms | tok/sec: 988.89
step   107 | loss: 9.907371 | lr 1.3317e-05 | norm: 2.4648 | dt: 1096.26ms | tok/sec: 934.08
step   108 | loss: 9.831129 | lr 1.3440e-05 | norm: 2.5031 | dt: 1050.20ms | tok/sec: 975.06
step   109 | loss: 9.821272 | lr 1.3564e-05 | norm: 2.4639 | dt: 1051.28ms | tok/sec: 974.05
step   110 | loss: 9.779215 | lr 1.3687e-05 | norm: 2.6089 | dt: 1335.92ms | tok/sec: 766.52
step   111 | loss: 9.675547 | lr 1.3810e-05 | norm: 2.6823 | dt: 1285.57ms | tok/sec: 796.54
step   112 | loss: 9.809279 | lr 1.3933e-05 | norm: 2.4309 | dt: 1410.90ms | tok/sec: 725.78
step   113 | loss: 9.738172 | lr 1.4057e-05 | norm: 2.5899 | dt: 1370.54ms | tok/sec: 747.15
step   114 | loss: 9.608898 | lr 1.4180e-05 | norm: 2.8887 | dt: 1415.18ms | tok/sec: 723.58
step   115 | loss: 9.790100 | lr 1.4303e-05 | norm: 2.3985 | dt: 1399.51ms | tok/sec: 731.68
step   116 | loss: 9.806711 | lr 1.4427e-05 | norm: 2.6006 | dt: 1388.35ms | tok/sec: 737.57
step   117 | loss: 9.669735 | lr 1.4550e-05 | norm: 2.6427 | dt: 1384.63ms | tok/sec: 739.55
step   118 | loss: 9.670038 | lr 1.4673e-05 | norm: 2.6501 | dt: 1418.92ms | tok/sec: 721.68
step   119 | loss: 9.889437 | lr 1.4797e-05 | norm: 2.7636 | dt: 1382.20ms | tok/sec: 740.85
step   120 | loss: 9.855852 | lr 1.4920e-05 | norm: 2.9388 | dt: 1463.86ms | tok/sec: 699.52
step   121 | loss: 9.842205 | lr 1.5043e-05 | norm: 2.7459 | dt: 1351.41ms | tok/sec: 757.73
step   122 | loss: 9.803297 | lr 1.5166e-05 | norm: 2.6718 | dt: 1398.20ms | tok/sec: 732.37
step   123 | loss: 9.829907 | lr 1.5290e-05 | norm: 2.4383 | dt: 1402.48ms | tok/sec: 730.14
step   124 | loss: 9.900427 | lr 1.5413e-05 | norm: 2.4964 | dt: 1379.58ms | tok/sec: 742.25
step   125 | loss: 9.923814 | lr 1.5536e-05 | norm: 2.3073 | dt: 1405.69ms | tok/sec: 728.47
step   126 | loss: 9.811461 | lr 1.5660e-05 | norm: 2.9108 | dt: 1371.06ms | tok/sec: 746.87
step   127 | loss: 9.784611 | lr 1.5783e-05 | norm: 2.7339 | dt: 1369.93ms | tok/sec: 747.48
step   128 | loss: 9.668568 | lr 1.5906e-05 | norm: 2.8122 | dt: 1345.40ms | tok/sec: 761.11
step   129 | loss: 9.590021 | lr 1.6030e-05 | norm: 2.7257 | dt: 1403.88ms | tok/sec: 729.41
step   130 | loss: 9.773763 | lr 1.6153e-05 | norm: 2.6708 | dt: 1411.55ms | tok/sec: 725.45
step   131 | loss: 9.613767 | lr 1.6276e-05 | norm: 2.5119 | dt: 1374.72ms | tok/sec: 744.88
step   132 | loss: 9.742558 | lr 1.6400e-05 | norm: 2.5238 | dt: 1395.74ms | tok/sec: 733.66
step   133 | loss: 9.782520 | lr 1.6523e-05 | norm: 2.3681 | dt: 1375.20ms | tok/sec: 744.62
step   134 | loss: 9.457749 | lr 1.6646e-05 | norm: 2.9883 | dt: 1381.34ms | tok/sec: 741.31
step   135 | loss: 9.649501 | lr 1.6769e-05 | norm: 2.8434 | dt: 1388.41ms | tok/sec: 737.53
step   136 | loss: 9.660896 | lr 1.6893e-05 | norm: 2.8485 | dt: 1380.50ms | tok/sec: 741.76
step   137 | loss: 9.629246 | lr 1.7016e-05 | norm: 2.6817 | dt: 1365.22ms | tok/sec: 750.06
step   138 | loss: 9.601376 | lr 1.7139e-05 | norm: 2.9197 | dt: 1433.41ms | tok/sec: 714.38
step   139 | loss: 9.265005 | lr 1.7263e-05 | norm: 3.3830 | dt: 1425.63ms | tok/sec: 718.28
step   140 | loss: 9.420914 | lr 1.7386e-05 | norm: 3.1264 | dt: 1358.18ms | tok/sec: 753.95
step   141 | loss: 9.653292 | lr 1.7509e-05 | norm: 2.8664 | dt: 1387.60ms | tok/sec: 737.97
step   142 | loss: 9.493800 | lr 1.7633e-05 | norm: 3.0096 | dt: 1390.63ms | tok/sec: 736.36
step   143 | loss: 9.452425 | lr 1.7756e-05 | norm: 3.0416 | dt: 1376.11ms | tok/sec: 744.13
step   144 | loss: 9.563163 | lr 1.7879e-05 | norm: 2.7482 | dt: 1427.56ms | tok/sec: 717.31
step   145 | loss: 9.362741 | lr 1.8002e-05 | norm: 3.0507 | dt: 1411.96ms | tok/sec: 725.23
step   146 | loss: 9.686157 | lr 1.8126e-05 | norm: 2.6011 | dt: 1407.45ms | tok/sec: 727.56
step   147 | loss: 9.927055 | lr 1.8249e-05 | norm: 2.3588 | dt: 1381.32ms | tok/sec: 741.32
step   148 | loss: 9.947310 | lr 1.8372e-05 | norm: 2.4582 | dt: 1357.67ms | tok/sec: 754.23
step   149 | loss: 10.058414 | lr 1.8496e-05 | norm: 2.2730 | dt: 1446.84ms | tok/sec: 707.75
step   150 | loss: 9.903828 | lr 1.8619e-05 | norm: 2.3284 | dt: 1384.52ms | tok/sec: 739.61
step   151 | loss: 9.463352 | lr 1.8742e-05 | norm: 2.9593 | dt: 1445.62ms | tok/sec: 708.35
step   152 | loss: 9.374350 | lr 1.8866e-05 | norm: 2.9851 | dt: 1402.93ms | tok/sec: 729.90
step   153 | loss: 9.569748 | lr 1.8989e-05 | norm: 2.9623 | dt: 1372.91ms | tok/sec: 745.86
step   154 | loss: 9.446387 | lr 1.9112e-05 | norm: 2.8550 | dt: 1415.76ms | tok/sec: 723.29
step   155 | loss: 9.491755 | lr 1.9236e-05 | norm: 2.8458 | dt: 1381.98ms | tok/sec: 740.96
step   156 | loss: 9.373604 | lr 1.9359e-05 | norm: 2.8929 | dt: 1403.35ms | tok/sec: 729.68
step   157 | loss: 9.393854 | lr 1.9482e-05 | norm: 3.0797 | dt: 1383.16ms | tok/sec: 740.33
step   158 | loss: 9.356611 | lr 1.9605e-05 | norm: 2.9627 | dt: 1380.46ms | tok/sec: 741.78
step   159 | loss: 9.362486 | lr 1.9729e-05 | norm: 3.2706 | dt: 1402.61ms | tok/sec: 730.07
step   160 | loss: 9.355361 | lr 1.9852e-05 | norm: 3.1441 | dt: 1381.07ms | tok/sec: 741.45
step   161 | loss: 9.554586 | lr 1.9975e-05 | norm: 2.6174 | dt: 1355.24ms | tok/sec: 755.59
step   162 | loss: 9.568199 | lr 2.0099e-05 | norm: 2.8619 | dt: 1427.21ms | tok/sec: 717.48
step   163 | loss: 9.435568 | lr 2.0222e-05 | norm: 2.7107 | dt: 1372.76ms | tok/sec: 745.94
step   164 | loss: 9.832304 | lr 2.0345e-05 | norm: 2.5414 | dt: 1433.55ms | tok/sec: 714.31
step   165 | loss: 9.816260 | lr 2.0469e-05 | norm: 2.6526 | dt: 1391.18ms | tok/sec: 736.07
step   166 | loss: 9.592810 | lr 2.0592e-05 | norm: 2.4377 | dt: 1334.84ms | tok/sec: 767.13
step   167 | loss: 10.088931 | lr 2.0715e-05 | norm: 5.3956 | dt: 1389.51ms | tok/sec: 736.95
step   168 | loss: 9.369478 | lr 2.0838e-05 | norm: 3.3406 | dt: 1318.40ms | tok/sec: 776.70
step   169 | loss: 9.513197 | lr 2.0962e-05 | norm: 2.9357 | dt: 1464.39ms | tok/sec: 699.27
step   170 | loss: 9.605496 | lr 2.1085e-05 | norm: 2.5921 | dt: 1384.02ms | tok/sec: 739.88
step   171 | loss: 9.752321 | lr 2.1208e-05 | norm: 2.4836 | dt: 1419.07ms | tok/sec: 721.60
step   172 | loss: 9.473381 | lr 2.1332e-05 | norm: 4.0780 | dt: 1376.48ms | tok/sec: 743.92
step   173 | loss: 9.337063 | lr 2.1455e-05 | norm: 4.0444 | dt: 1381.99ms | tok/sec: 740.96
step   174 | loss: 9.635931 | lr 2.1578e-05 | norm: 2.7145 | dt: 1429.28ms | tok/sec: 716.45
step   175 | loss: 9.675824 | lr 2.1702e-05 | norm: 2.5536 | dt: 1395.26ms | tok/sec: 733.92
step   176 | loss: 9.507451 | lr 2.1825e-05 | norm: 2.8172 | dt: 1398.74ms | tok/sec: 732.09
step   177 | loss: 9.617567 | lr 2.1948e-05 | norm: 2.5429 | dt: 1395.38ms | tok/sec: 733.85
step   178 | loss: 9.536454 | lr 2.2072e-05 | norm: 2.7151 | dt: 1358.53ms | tok/sec: 753.75
step   179 | loss: 9.533325 | lr 2.2195e-05 | norm: 2.8149 | dt: 1414.58ms | tok/sec: 723.89
step   180 | loss: 9.673903 | lr 2.2318e-05 | norm: 2.5737 | dt: 1407.01ms | tok/sec: 727.78
step   181 | loss: 9.757775 | lr 2.2441e-05 | norm: 2.2829 | dt: 1393.13ms | tok/sec: 735.04
step   182 | loss: 9.796228 | lr 2.2565e-05 | norm: 2.5005 | dt: 1410.37ms | tok/sec: 726.05
step   183 | loss: 9.648111 | lr 2.2688e-05 | norm: 2.4088 | dt: 1368.86ms | tok/sec: 748.07
step   184 | loss: 9.765463 | lr 2.2811e-05 | norm: 2.5268 | dt: 1404.60ms | tok/sec: 729.03
step   185 | loss: 9.760744 | lr 2.2935e-05 | norm: 2.4469 | dt: 1387.20ms | tok/sec: 738.18
step   186 | loss: 9.707638 | lr 2.3058e-05 | norm: 2.4245 | dt: 1416.21ms | tok/sec: 723.05
step   187 | loss: 9.690144 | lr 2.3181e-05 | norm: 2.2823 | dt: 1431.76ms | tok/sec: 715.20
step   188 | loss: 9.737589 | lr 2.3305e-05 | norm: 2.7827 | dt: 1630.98ms | tok/sec: 627.84
step   189 | loss: 9.662327 | lr 2.3428e-05 | norm: 2.5805 | dt: 1687.71ms | tok/sec: 606.74
step   190 | loss: 9.637552 | lr 2.3551e-05 | norm: 2.4824 | dt: 1814.93ms | tok/sec: 564.21
step   191 | loss: 9.679205 | lr 2.3674e-05 | norm: 2.3492 | dt: 1744.60ms | tok/sec: 586.95
step   192 | loss: 9.622339 | lr 2.3798e-05 | norm: 2.4254 | dt: 1739.78ms | tok/sec: 588.58
step   193 | loss: 9.423752 | lr 2.3921e-05 | norm: 2.8400 | dt: 1700.74ms | tok/sec: 602.09
step   194 | loss: 9.459011 | lr 2.4044e-05 | norm: 2.7378 | dt: 1736.14ms | tok/sec: 589.82
step   195 | loss: 9.600582 | lr 2.4168e-05 | norm: 2.4250 | dt: 1731.10ms | tok/sec: 591.53
step   196 | loss: 9.497174 | lr 2.4291e-05 | norm: 2.5032 | dt: 1718.08ms | tok/sec: 596.02
step   197 | loss: 9.544798 | lr 2.4414e-05 | norm: 2.4592 | dt: 1741.21ms | tok/sec: 588.10
step   198 | loss: 9.591537 | lr 2.4538e-05 | norm: 2.7104 | dt: 1730.17ms | tok/sec: 591.85
step   199 | loss: 9.427538 | lr 2.4661e-05 | norm: 2.5788 | dt: 1728.17ms | tok/sec: 592.53
step   200 | loss: 9.555159 | lr 2.4784e-05 | norm: 2.3941 | dt: 1748.51ms | tok/sec: 585.64
step   201 | loss: 9.450774 | lr 2.4908e-05 | norm: 2.5677 | dt: 1736.84ms | tok/sec: 589.58
step   202 | loss: 9.661595 | lr 2.5031e-05 | norm: 2.8622 | dt: 1763.08ms | tok/sec: 580.80
step   203 | loss: 9.885558 | lr 2.5154e-05 | norm: 2.7160 | dt: 1737.42ms | tok/sec: 589.38
step   204 | loss: 9.429049 | lr 2.5277e-05 | norm: 3.0780 | dt: 1721.22ms | tok/sec: 594.93
step   205 | loss: 9.428816 | lr 2.5401e-05 | norm: 2.5761 | dt: 1767.39ms | tok/sec: 579.39
step   206 | loss: 9.516844 | lr 2.5524e-05 | norm: 2.9983 | dt: 1738.67ms | tok/sec: 588.96
step   207 | loss: 9.637663 | lr 2.5647e-05 | norm: 2.7316 | dt: 1742.59ms | tok/sec: 587.63
step   208 | loss: 9.652645 | lr 2.5771e-05 | norm: 2.6423 | dt: 1780.37ms | tok/sec: 575.16
step   209 | loss: 9.609282 | lr 2.5894e-05 | norm: 2.7240 | dt: 1714.38ms | tok/sec: 597.30
step   210 | loss: 9.467807 | lr 2.6017e-05 | norm: 2.4973 | dt: 1717.54ms | tok/sec: 596.20
step   211 | loss: 9.565733 | lr 2.6141e-05 | norm: 2.8663 | dt: 1734.80ms | tok/sec: 590.27
step   212 | loss: 9.556053 | lr 2.6264e-05 | norm: 3.0706 | dt: 1721.35ms | tok/sec: 594.88
step   213 | loss: 9.618389 | lr 2.6387e-05 | norm: 2.5140 | dt: 1735.50ms | tok/sec: 590.03
step   214 | loss: 9.714752 | lr 2.6510e-05 | norm: 2.4939 | dt: 1734.41ms | tok/sec: 590.40
step   215 | loss: 9.536188 | lr 2.6634e-05 | norm: 2.4133 | dt: 1754.40ms | tok/sec: 583.68
step   216 | loss: 9.615865 | lr 2.6757e-05 | norm: 2.4896 | dt: 1723.58ms | tok/sec: 594.11
step   217 | loss: 9.460566 | lr 2.6880e-05 | norm: 2.6925 | dt: 1750.28ms | tok/sec: 585.05
step   218 | loss: 9.509545 | lr 2.7004e-05 | norm: 2.5792 | dt: 1735.29ms | tok/sec: 590.10
step   219 | loss: 9.639862 | lr 2.7127e-05 | norm: 2.9640 | dt: 1745.81ms | tok/sec: 586.55
step   220 | loss: 9.679480 | lr 2.7250e-05 | norm: 2.5215 | dt: 1749.22ms | tok/sec: 585.40
step   221 | loss: 9.066093 | lr 2.7374e-05 | norm: 3.2298 | dt: 1745.20ms | tok/sec: 586.75
step   222 | loss: 9.322319 | lr 2.7497e-05 | norm: 2.7662 | dt: 1731.04ms | tok/sec: 591.55
step   223 | loss: 9.617977 | lr 2.7620e-05 | norm: 2.2812 | dt: 1759.62ms | tok/sec: 581.94
step   224 | loss: 9.427821 | lr 2.7744e-05 | norm: 2.5763 | dt: 1732.07ms | tok/sec: 591.20
step   225 | loss: 9.530233 | lr 2.7867e-05 | norm: 2.4324 | dt: 1752.84ms | tok/sec: 584.20
step   226 | loss: 9.517958 | lr 2.7990e-05 | norm: 2.6330 | dt: 1740.66ms | tok/sec: 588.28
step   227 | loss: 9.457905 | lr 2.8113e-05 | norm: 2.6467 | dt: 1716.44ms | tok/sec: 596.58
step   228 | loss: 9.472715 | lr 2.8237e-05 | norm: 2.8603 | dt: 1730.54ms | tok/sec: 591.72
step   229 | loss: 9.763313 | lr 2.8360e-05 | norm: 2.5689 | dt: 1739.78ms | tok/sec: 588.58
step   230 | loss: 10.303670 | lr 2.8483e-05 | norm: 3.0974 | dt: 1760.05ms | tok/sec: 581.80
step   231 | loss: 9.602698 | lr 2.8607e-05 | norm: 2.4185 | dt: 1731.84ms | tok/sec: 591.28
step   232 | loss: 9.613705 | lr 2.8730e-05 | norm: 2.2466 | dt: 1743.68ms | tok/sec: 587.26
step   233 | loss: 9.433933 | lr 2.8853e-05 | norm: 2.7108 | dt: 1717.46ms | tok/sec: 596.23
step   234 | loss: 9.835682 | lr 2.8977e-05 | norm: 2.1861 | dt: 1758.40ms | tok/sec: 582.35
step   235 | loss: 9.509090 | lr 2.9100e-05 | norm: 2.3213 | dt: 1732.40ms | tok/sec: 591.09
step   236 | loss: 9.425093 | lr 2.9223e-05 | norm: 2.3794 | dt: 1743.46ms | tok/sec: 587.34
step   237 | loss: 9.586655 | lr 2.9346e-05 | norm: 2.2382 | dt: 1767.58ms | tok/sec: 579.32
step   238 | loss: 9.595881 | lr 2.9470e-05 | norm: 2.2408 | dt: 1722.61ms | tok/sec: 594.45
step   239 | loss: 9.435804 | lr 2.9593e-05 | norm: 2.4675 | dt: 1753.90ms | tok/sec: 583.84
step   240 | loss: 9.288784 | lr 2.9716e-05 | norm: 2.4428 | dt: 1768.87ms | tok/sec: 578.90
step   241 | loss: 9.595207 | lr 2.9840e-05 | norm: 2.2964 | dt: 1768.41ms | tok/sec: 579.05
step   242 | loss: 9.341822 | lr 2.9963e-05 | norm: 2.3870 | dt: 1739.91ms | tok/sec: 588.54
step   243 | loss: 9.593923 | lr 3.0086e-05 | norm: 2.1561 | dt: 1748.69ms | tok/sec: 585.58
step   244 | loss: 9.527624 | lr 3.0210e-05 | norm: 2.6398 | dt: 1718.92ms | tok/sec: 595.72
step   245 | loss: 9.444398 | lr 3.0333e-05 | norm: 2.6032 | dt: 1738.16ms | tok/sec: 589.13
step   246 | loss: 9.706345 | lr 3.0456e-05 | norm: 2.1553 | dt: 1752.45ms | tok/sec: 584.33
step   247 | loss: 9.564043 | lr 3.0580e-05 | norm: 2.3257 | dt: 1720.03ms | tok/sec: 595.34
step   248 | loss: 9.524316 | lr 3.0703e-05 | norm: 2.2041 | dt: 1740.38ms | tok/sec: 588.38
step   249 | loss: 9.620182 | lr 3.0826e-05 | norm: 2.6890 | dt: 1740.97ms | tok/sec: 588.18
step   250 | loss: 9.439361 | lr 3.0949e-05 | norm: 2.4615 | dt: 1733.45ms | tok/sec: 590.73
step   251 | loss: 9.479496 | lr 3.1073e-05 | norm: 2.3193 | dt: 1744.25ms | tok/sec: 587.07
step   252 | loss: 9.592482 | lr 3.1196e-05 | norm: 2.2526 | dt: 1747.05ms | tok/sec: 586.13
step   253 | loss: 9.578833 | lr 3.1319e-05 | norm: 2.3885 | dt: 1753.38ms | tok/sec: 584.01
step   254 | loss: 9.552353 | lr 3.1443e-05 | norm: 2.3830 | dt: 1729.42ms | tok/sec: 592.10
step   255 | loss: 9.551495 | lr 3.1566e-05 | norm: 2.4207 | dt: 1725.63ms | tok/sec: 593.41
step   256 | loss: 9.455774 | lr 3.1689e-05 | norm: 2.5095 | dt: 1726.57ms | tok/sec: 593.08
step   257 | loss: 9.477948 | lr 3.1813e-05 | norm: 2.4558 | dt: 1758.08ms | tok/sec: 582.45
step   258 | loss: 9.424241 | lr 3.1936e-05 | norm: 2.5389 | dt: 1734.16ms | tok/sec: 590.49
step   259 | loss: 9.423188 | lr 3.2059e-05 | norm: 2.6059 | dt: 1762.40ms | tok/sec: 581.03
step   260 | loss: 9.559781 | lr 3.2182e-05 | norm: 2.5870 | dt: 1737.06ms | tok/sec: 589.50
step   261 | loss: 9.445249 | lr 3.2306e-05 | norm: 2.4793 | dt: 1712.56ms | tok/sec: 597.94
step   262 | loss: 9.483324 | lr 3.2429e-05 | norm: 2.1707 | dt: 1745.10ms | tok/sec: 586.79
step   263 | loss: 9.312531 | lr 3.2552e-05 | norm: 2.4442 | dt: 1733.84ms | tok/sec: 590.60
step   264 | loss: 9.430579 | lr 3.2676e-05 | norm: 2.3378 | dt: 1737.31ms | tok/sec: 589.42
step   265 | loss: 9.555078 | lr 3.2799e-05 | norm: 2.2892 | dt: 1768.65ms | tok/sec: 578.97
step   266 | loss: 9.346853 | lr 3.2922e-05 | norm: 2.3587 | dt: 1709.26ms | tok/sec: 599.09
step   267 | loss: 9.249421 | lr 3.3046e-05 | norm: 2.7153 | dt: 1747.68ms | tok/sec: 585.92
step   268 | loss: 9.468317 | lr 3.3169e-05 | norm: 2.4220 | dt: 1751.05ms | tok/sec: 584.79
step   269 | loss: 9.620758 | lr 3.3292e-05 | norm: 2.2855 | dt: 1714.14ms | tok/sec: 597.39
step   270 | loss: 9.518756 | lr 3.3416e-05 | norm: 2.3901 | dt: 1738.77ms | tok/sec: 588.92
step   271 | loss: 9.424037 | lr 3.3539e-05 | norm: 2.4704 | dt: 1730.61ms | tok/sec: 591.70
step   272 | loss: 9.499346 | lr 3.3662e-05 | norm: 2.6256 | dt: 1749.40ms | tok/sec: 585.34
step   273 | loss: 9.321630 | lr 3.3785e-05 | norm: 2.5721 | dt: 1725.81ms | tok/sec: 593.35
step   274 | loss: 9.478841 | lr 3.3909e-05 | norm: 2.4439 | dt: 1744.58ms | tok/sec: 586.96
step   275 | loss: 9.187389 | lr 3.4032e-05 | norm: 2.8262 | dt: 1759.39ms | tok/sec: 582.02
step   276 | loss: 9.100698 | lr 3.4155e-05 | norm: 2.6924 | dt: 1688.17ms | tok/sec: 606.57
step   277 | loss: 9.210362 | lr 3.4279e-05 | norm: 2.5091 | dt: 1740.75ms | tok/sec: 588.25
step   278 | loss: 9.380139 | lr 3.4402e-05 | norm: 2.2425 | dt: 1812.31ms | tok/sec: 565.02
step   279 | loss: 9.461754 | lr 3.4525e-05 | norm: 2.2505 | dt: 1713.52ms | tok/sec: 597.60
step   280 | loss: 9.331184 | lr 3.4649e-05 | norm: 2.2950 | dt: 1730.12ms | tok/sec: 591.87
step   281 | loss: 9.352804 | lr 3.4772e-05 | norm: 2.3068 | dt: 1750.84ms | tok/sec: 584.86
step   282 | loss: 9.813208 | lr 3.4895e-05 | norm: 2.0438 | dt: 1702.56ms | tok/sec: 601.45
step   283 | loss: 9.657904 | lr 3.5018e-05 | norm: 2.4892 | dt: 1741.28ms | tok/sec: 588.07
step   284 | loss: 9.483637 | lr 3.5142e-05 | norm: 2.2365 | dt: 1741.22ms | tok/sec: 588.09
step   285 | loss: 9.307316 | lr 3.5265e-05 | norm: 2.4423 | dt: 1717.66ms | tok/sec: 596.16
step   286 | loss: 9.489536 | lr 3.5388e-05 | norm: 2.3517 | dt: 1749.91ms | tok/sec: 585.17
step   287 | loss: 9.460574 | lr 3.5512e-05 | norm: 2.3416 | dt: 1702.61ms | tok/sec: 601.43
step   288 | loss: 9.628048 | lr 3.5635e-05 | norm: 2.6274 | dt: 1753.62ms | tok/sec: 583.93
step   289 | loss: 9.391266 | lr 3.5758e-05 | norm: 2.4362 | dt: 1718.66ms | tok/sec: 595.81
step   290 | loss: 9.207698 | lr 3.5882e-05 | norm: 2.5152 | dt: 1736.11ms | tok/sec: 589.83
step   291 | loss: 9.391817 | lr 3.6005e-05 | norm: 2.3292 | dt: 1751.86ms | tok/sec: 584.52
step   292 | loss: 9.449102 | lr 3.6128e-05 | norm: 2.2989 | dt: 1731.27ms | tok/sec: 591.47
step   293 | loss: 9.477663 | lr 3.6252e-05 | norm: 2.3212 | dt: 1890.42ms | tok/sec: 541.68
step   294 | loss: 9.715759 | lr 3.6375e-05 | norm: 2.0580 | dt: 1916.82ms | tok/sec: 534.22
step   295 | loss: 9.740019 | lr 3.6498e-05 | norm: 2.0347 | dt: 1761.81ms | tok/sec: 581.22
step   296 | loss: 9.950678 | lr 3.6621e-05 | norm: 2.2029 | dt: 1707.81ms | tok/sec: 599.60
step   297 | loss: 9.479289 | lr 3.6745e-05 | norm: 2.2822 | dt: 1714.42ms | tok/sec: 597.29
step   298 | loss: 9.383715 | lr 3.6868e-05 | norm: 2.2817 | dt: 1687.29ms | tok/sec: 606.89
step   299 | loss: 9.683726 | lr 3.6991e-05 | norm: 2.1323 | dt: 1749.75ms | tok/sec: 585.23
step   300 | loss: 9.799806 | lr 3.7115e-05 | norm: 2.2880 | dt: 1738.50ms | tok/sec: 589.01
step   301 | loss: 9.408716 | lr 3.7238e-05 | norm: 2.3175 | dt: 1731.43ms | tok/sec: 591.42
step   302 | loss: 9.555799 | lr 3.7361e-05 | norm: 2.2470 | dt: 1731.92ms | tok/sec: 591.25
step   303 | loss: 9.491708 | lr 3.7485e-05 | norm: 2.3503 | dt: 1716.16ms | tok/sec: 596.68
step   304 | loss: 9.510021 | lr 3.7608e-05 | norm: 2.3164 | dt: 1712.78ms | tok/sec: 597.86
step   305 | loss: 9.478294 | lr 3.7731e-05 | norm: 2.2542 | dt: 1745.75ms | tok/sec: 586.57
step   306 | loss: 9.555664 | lr 3.7855e-05 | norm: 2.2408 | dt: 1766.11ms | tok/sec: 579.81
step   307 | loss: 9.568278 | lr 3.7978e-05 | norm: 2.1094 | dt: 1701.59ms | tok/sec: 601.79
step   308 | loss: 9.355631 | lr 3.8101e-05 | norm: 2.2648 | dt: 1737.35ms | tok/sec: 589.40
step   309 | loss: 9.348254 | lr 3.8224e-05 | norm: 2.3644 | dt: 1736.57ms | tok/sec: 589.67
step   310 | loss: 9.508934 | lr 3.8348e-05 | norm: 2.2600 | dt: 1713.91ms | tok/sec: 597.46
step   311 | loss: 9.402026 | lr 3.8471e-05 | norm: 2.4284 | dt: 1770.65ms | tok/sec: 578.32
step   312 | loss: 9.532842 | lr 3.8594e-05 | norm: 2.2300 | dt: 1778.52ms | tok/sec: 575.76
step   313 | loss: 9.609275 | lr 3.8718e-05 | norm: 2.2123 | dt: 1727.84ms | tok/sec: 592.65
step   314 | loss: 9.612786 | lr 3.8841e-05 | norm: 2.5323 | dt: 1748.24ms | tok/sec: 585.73
step   315 | loss: 9.598478 | lr 3.8964e-05 | norm: 2.8175 | dt: 1705.15ms | tok/sec: 600.53
step   316 | loss: 9.516780 | lr 3.9088e-05 | norm: 2.3181 | dt: 1722.67ms | tok/sec: 594.43
step   317 | loss: 9.108701 | lr 3.9211e-05 | norm: 3.2182 | dt: 1756.00ms | tok/sec: 583.14
step   318 | loss: 9.191658 | lr 3.9334e-05 | norm: 2.9735 | dt: 1748.24ms | tok/sec: 585.73
step   319 | loss: 9.275153 | lr 3.9457e-05 | norm: 2.4787 | dt: 1724.25ms | tok/sec: 593.88
step   320 | loss: 9.356328 | lr 3.9581e-05 | norm: 2.4634 | dt: 1736.98ms | tok/sec: 589.53
step   321 | loss: 9.433967 | lr 3.9704e-05 | norm: 2.2222 | dt: 1748.30ms | tok/sec: 585.71
step   322 | loss: 9.514591 | lr 3.9827e-05 | norm: 2.4664 | dt: 1780.59ms | tok/sec: 575.09
step   323 | loss: 9.088650 | lr 3.9951e-05 | norm: 2.7809 | dt: 1765.20ms | tok/sec: 580.11
step   324 | loss: 9.202833 | lr 4.0074e-05 | norm: 2.6545 | dt: 1699.50ms | tok/sec: 602.53
step   325 | loss: 9.496664 | lr 4.0197e-05 | norm: 3.5977 | dt: 1727.98ms | tok/sec: 592.60
step   326 | loss: 9.263943 | lr 4.0321e-05 | norm: 2.9509 | dt: 1694.98ms | tok/sec: 604.14
step   327 | loss: 9.596669 | lr 4.0444e-05 | norm: 2.5150 | dt: 1756.14ms | tok/sec: 583.10
step   328 | loss: 9.363556 | lr 4.0567e-05 | norm: 2.7307 | dt: 1705.58ms | tok/sec: 600.38
step   329 | loss: 9.672966 | lr 4.0691e-05 | norm: 2.1198 | dt: 1703.49ms | tok/sec: 601.12
step   330 | loss: 9.587327 | lr 4.0814e-05 | norm: 2.2323 | dt: 1721.89ms | tok/sec: 594.70
step   331 | loss: 9.392611 | lr 4.0937e-05 | norm: 2.2940 | dt: 1747.11ms | tok/sec: 586.11
step   332 | loss: 9.529962 | lr 4.1060e-05 | norm: 2.1222 | dt: 1738.54ms | tok/sec: 589.00
step   333 | loss: 9.436132 | lr 4.1184e-05 | norm: 2.3694 | dt: 1719.01ms | tok/sec: 595.69
step   334 | loss: 9.613352 | lr 4.1307e-05 | norm: 2.0506 | dt: 1737.37ms | tok/sec: 589.40
step   335 | loss: 9.531452 | lr 4.1430e-05 | norm: 2.2065 | dt: 1729.90ms | tok/sec: 591.94
step   336 | loss: 9.499701 | lr 4.1554e-05 | norm: 2.3398 | dt: 1774.61ms | tok/sec: 577.03
step   337 | loss: 9.552642 | lr 4.1677e-05 | norm: 2.2717 | dt: 1716.80ms | tok/sec: 596.46
step   338 | loss: 9.428963 | lr 4.1800e-05 | norm: 2.1200 | dt: 1721.02ms | tok/sec: 594.99
step   339 | loss: 9.445011 | lr 4.1924e-05 | norm: 2.3354 | dt: 1693.90ms | tok/sec: 604.52
step   340 | loss: 9.306963 | lr 4.2047e-05 | norm: 2.5311 | dt: 1727.36ms | tok/sec: 592.81
step   341 | loss: 9.720677 | lr 4.2170e-05 | norm: 2.0830 | dt: 1727.49ms | tok/sec: 592.77
step   342 | loss: 9.267515 | lr 4.2293e-05 | norm: 2.4485 | dt: 1734.21ms | tok/sec: 590.47
step   343 | loss: 9.099787 | lr 4.2417e-05 | norm: 2.8354 | dt: 1729.06ms | tok/sec: 592.23
step   344 | loss: 9.076199 | lr 4.2540e-05 | norm: 2.8299 | dt: 1730.00ms | tok/sec: 591.91
step   345 | loss: 9.042939 | lr 4.2663e-05 | norm: 2.9413 | dt: 1735.65ms | tok/sec: 589.98
step   346 | loss: 9.288978 | lr 4.2787e-05 | norm: 2.4958 | dt: 1719.53ms | tok/sec: 595.51
step   347 | loss: 9.634575 | lr 4.2910e-05 | norm: 2.2554 | dt: 1702.54ms | tok/sec: 601.46
step   348 | loss: 9.904591 | lr 4.3033e-05 | norm: 2.2125 | dt: 1744.30ms | tok/sec: 587.06
step   349 | loss: 9.671526 | lr 4.3157e-05 | norm: 2.3898 | dt: 1706.89ms | tok/sec: 599.92
step   350 | loss: 9.615013 | lr 4.3280e-05 | norm: 2.2355 | dt: 1854.79ms | tok/sec: 552.08
step   351 | loss: 9.011217 | lr 4.3403e-05 | norm: 3.5276 | dt: 2026.51ms | tok/sec: 505.30
step   352 | loss: 9.601812 | lr 4.3527e-05 | norm: 2.5897 | dt: 2094.58ms | tok/sec: 488.88
CUDA Allocation Failed: out of memory(requested 147 MB
ERROR: CUDA allcation failed
make: *** [Makefile:96: run-snippet] Error 1
