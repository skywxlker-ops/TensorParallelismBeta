
=== DTensor Language Model Training ===
World size: 2
Config: B=8, T=1024, n_embd=256, hidden=512 (4-layer MLP)
Training: 2000 steps, warmup=10, lr=0.001 -> 0.0001
Dataset files:
  Train:
    [OK] ../data/edufineweb_train_000001.bin
    [OK] ../data/edufineweb_train_000002.bin
    [OK] ../data/edufineweb_train_000003.bin
  Val:
    [OK] ../data/edufineweb_val_00000.bin
DataLoader: using 3 explicit files
  - ../data/edufineweb_train_000001.bin
  - ../data/edufineweb_train_000002.bin
  - ../data/edufineweb_train_000003.bin
DataLoader: using 1 explicit files
  - ../data/edufineweb_val_00000.bin

Starting training for 2000 steps...
Running validation...
Step 0 Validation Loss: 11.8532
step     0 | loss: 11.8625 | val: 11.8532 | lr: 1.00e-04 | norm: 0.9625 | dt: 6768.83ms | tok/sec: 1210.25
step    10 | loss: 9.9488 | lr: 1.00e-03 | norm: 1.2438 | dt: 505.25ms | tok/sec: 16213.83
step    20 | loss: 8.4501 | lr: 1.00e-03 | norm: 0.7599 | dt: 518.36ms | tok/sec: 15803.68
step    30 | loss: 7.9770 | lr: 1.00e-03 | norm: 0.5577 | dt: 514.46ms | tok/sec: 15923.63
step    40 | loss: 7.8197 | lr: 9.99e-04 | norm: 0.5655 | dt: 514.08ms | tok/sec: 15935.23
step    50 | loss: 7.5491 | lr: 9.99e-04 | norm: 0.5350 | dt: 509.34ms | tok/sec: 16083.50
step    60 | loss: 7.9264 | lr: 9.99e-04 | norm: 0.6155 | dt: 512.37ms | tok/sec: 15988.40
step    70 | loss: 7.5873 | lr: 9.98e-04 | norm: 0.4661 | dt: 515.62ms | tok/sec: 15887.77
step    80 | loss: 7.8446 | lr: 9.97e-04 | norm: 0.3183 | dt: 531.99ms | tok/sec: 15398.67
step    90 | loss: 7.6624 | lr: 9.96e-04 | norm: 0.3945 | dt: 510.58ms | tok/sec: 16044.59
Running validation...
Step 100 Validation Loss: 7.59
step   100 | loss: 7.4909 | val: 7.5920 | lr: 9.95e-04 | norm: 0.5620 | dt: 4242.18ms | tok/sec: 1931.08
step   110 | loss: 7.5149 | lr: 9.94e-04 | norm: 0.4007 | dt: 514.86ms | tok/sec: 15911.12
step   120 | loss: 7.4326 | lr: 9.93e-04 | norm: 0.7048 | dt: 512.51ms | tok/sec: 15984.18
